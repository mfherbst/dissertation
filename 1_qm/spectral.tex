\section{Spectral theory}
\todo[inline,caption={}]{
	\begin{itemize}
		\item Elaborate on the spectral theory of bounded operators
		\item Sturm-Liouville theory
		\item See Erics notes
		\item Keep it short, just what is needed for HF
	\end{itemize}
}

\subsection{Bounded and self-adjoint operators}

\begin{defn}
	A \newterm{linear operator} on a Hilbert space $\hilbert$
	is the linear map $\Op{A} : D(\Op{A}) \to \hilbert$,
	where $D(\Op{A}) \subset \hilbert$ is a subspace
	called the \newterm{domain} of $\Op{A}$.
\end{defn}
Typically we employ just the term \newterm{operator} to refer to linear operators.
Recall that a mapping is called \newterm{linear} if the condition
\[ TODO \]
holds.
Even though not strictly necessary, we will assume for our treatment
that the Hilbert space is separable and that the domain of an operator
is always dense in it.

\newcommand{\opnorm}[1]{\norm{#1}_{\mathcal{L}(\hilbert)}}
\begin{defn}
	The inner product of $\hilbert$ induces an operator norm
	\[ \opnorm{\Op{A}} := \sup_{u \in \hilbert, u\neq0} \frac{\norm{A u}_\hilbert}{\norm{u}_{\hilbert}}. \]
\end{defn}

\begin{defn}
	A operator $\Op{A}$ on $\hilbert$ is \newterm{bounded} iff
	\[ \opnorm{\Op{A}} < \infty, \]
	\ie if it has finite operator norm.
\end{defn}
A bounded operator is also sometimes referred to as \newterm{continuous}%
~\footnote{In fact this is a consequence from the fact that a bounded linear operator
between normed vector spaces is always continuous}.

\begin{prop}
	Any linear operator on a finite-dimensional Hilbert space $\hilbert$ is bounded.
	\todoil{Maybe even compact}
\end{prop}
This allows it to be viewed as a multiplication by a finite matrix.

\begin{defn}
	Let $\Op{A}$ and $\Op{B}$ be operators on $\hilbert$.
	$\Op{B}$ is an \newterm{extension} of $\Op{A}$ if $D(\Op{A}) \subset D(\Op{B})$
	and if $\forall u \in D(\Op{A}: \Op{A}u = \Op{B}u$.
\end{defn}

\begin{defn}
	A operator $\Op{A}$ on $\hilbert$ which does not possess
	a bounded extension is called an \newterm{unbounded operator} on $\hilbert$.
\end{defn}

\begin{rem}
By the means of the Riesz representation theorem \vref{thm:Riesz}
we are able to uniquely define an operator $\Op{A}$ by
specifying the values of the sesquilinear form
\begin{equation}
	\hilbert \times \hilbert \ni (u, v) \mapsto a(u, v) := \braket{u}{\Op{A} v}_\hilbert \in \C
	\label{eqn:formA}
\end{equation}
\end{rem}

\begin{defn}
	A operator $\Op{A}$ on $\hilbert$ is called \newterm{symmetric} if
	\[ \forall (u, v) \in D(\Op{A}) \times D(\Op{A}): \qquad \braket{\Op{A} u}{v} = \braket{u}{\Op{A} v} \]
\end{defn}

\begin{defn}
	Let $\Op{A}$ be a linear operator on $\hilbert$ with (dense) domain $D(\Op{A})$
	and let $D(\tp{\Op{A}})$ be the vector space
	\[ D(\tp{\Op{A}}) = \left\{ v \in \hilbert \middle|
		\exists f_v \in \hilbert \ \text{such that} \
		\forall u \in D(\Op{A}): \braket{\Op{A} u}{v} = \braket{u}{f_v} \right\}.
	\]
	Then the linear operator $\tp{\Op{A}}$ with domain $D(\tp{\Op{A}})$,
	defined by
	\[ \forall v \in D(\tp{\Op{A}}) \quad \braket{\Op{A} u}{v} = \braket{u}{\tp{\Op{A}} v} \]
	is called the \newterm{adjoint} of $\Op{A}$.
\end{defn}
Note due to the Riesz theorem and the denseness of $D(\Op{A})$ in $\hilbert$
the $f_v$ is unique.

\begin{defn}
	A self-adjoint operator is an operator $\Op{A}$ for which $\tp{\Op{A}} = \Op{A}$.
	Note, that this implies both that the operator is symmetric \emph{and}
	that $D(\Op{A}) = D(\tp{\Op{A}})$.
\end{defn}

\begin{rem}
	For a bounded linear operator $\Op{A}$ with $D(\Op{A}) = \hilbert$
	the adjoint $\tp{\Op{A}}$ can be uniquely defined by
	\[ \forall (u,v) \in \hilbert \times \hilbert \quad \braket{\Op{A} u}{v} = \braket{u}{\tp{\Op{A}} v} \]
	This operator will be bounded, too.

	Comparing with the definition of a symmetric operator we find that for
	bounded operators the property of symmetric and self-adjoint are equivalent.
\end{rem}

It is important to note that
\begin{itemize}
	\item There is a simpler definition for adjoint for bounded operators
	\item For unbounded operators only self-adjoint $\Rightarrow$ symmetric
		and they are not equivalent
	\item Symmetric operators are not very interesting
		as they do not have the nice mathematical properties (real spectrum, spectral decomposition)
	\item Many \QM operators are not self-adjoint.
		They are ways to get around it by the means of special extensions.
	\item We will discuss those by the means of a couple of examples
		further down.
\end{itemize}

\subsection{Spectra of self-adjoint operators}
\begin{defn}
	A linear operator $\Op{A}$ is closed if its graph
	\[ \{ (u, \Op{A}u) | u \in D(\Op{A}) \} \]
	is a closed subspace of $\hilbert \times \hilbert$.
\end{defn}

\begin{prop}
	The adjoint of a linear operator is closed.
	\begin{proof}
		See \cite[p. 17]{Helffer2013}
	\end{proof}
\end{prop}
As a result all self-adjoint operators are closed.

\newcommand{\shiftop}{(\Op{A} - \lambda \id_{\hilbert})}
\begin{defn}
	Let $\Op{A}$ be a closed linear operator on $\Op{H}$.
	We call
	\begin{itemize}
		\item the open set
			\[ \rho(\Op{A}) = \left\{ \lambda \in \C \ \middle| \
				\shiftop \
				\text{is bijective on $D(\Op{A})$} \right\} \]
			the \newterm{resolvent set} of $\Op{A}$.
		\item the closed set $\sigma{\Op{A}} = \C \backslash \rho(\Op{A})$
			the \newterm{spectrum} of $\Op{A}$.
	\end{itemize}
\end{defn}
In infinite dimensions invertibility (bijectivity) is not idential to injectivity,
but in finite dimensions it can be made such.

\begin{prop}
	If $\Op{A}$ is self-adjoint (and hence closed), then $\sigma(\Op{A}\subset \R$.
	\begin{proof}
		See~\cite[p. 102]{Helffer2013}
	\end{proof}
\end{prop}

\begin{defn}
	If $\Op{A}$ is self-adjoint, we can decompose $\sigma(\Op{A}) = \sigma_P(\Op{A}) \dot{\cup} \sigma_C(\Op{A})$ where these sets are defined as
	\begin{itemize}
		\item the \newterm{point spectrum}
			\[ \sigma_P(\Op{A}) = \left\{ \lambda \in \R \middle| \shiftop\ \text{is non-injective} \right\}
				= \{ \text{eigenvalues of $\Op{A}$} \}\]
		\item the \newterm{continuous spectrum}
			\[ \sigma_C(\Op{A}) = \overline{\left\{ \lambda \in \R \middle| \shiftop\ \text{injective, but not surjective} \right\}}\]
			\ie the closure under the set
	\end{itemize}
\end{defn}
The RAGE theorem allows for the interpretation of the
point and the continuous spectrum in a physical way.
The point spectrum corresponds to the eigenstates of bound states,
whereas the (slide 25 eric october lectures)

From a numerical point of view another way of splitting the spectrum is interesting
\begin{defn}
	For any closed operator, we can decompose $\sigma(\Op{A}) = \sigma_\text{disc}(\Op{A}) \dot{\cup} \sigma_\text{ess}(\Op{A})$
	where
	\begin{itemize}
		\item the discrete spectrum%
			\footnote{For a mathematically more precise description, see~\cite[p.103 and p.132]{Helffer2013}.}
			\[ \sigma_\text{disc}(\Op{A}) \simeq \left\{ \lambda \in \R \middle| \text{$\lambda$ is an isolated eigenvalues of $\Op{A}$ with finite multiplicity} \right\} \]
		\item the essential spectrum
			\[\sigma_\text{ess}(\Op{A}) = \sigma(\Op{A}) \backslash \sigma_\text{disc}(\Op{A})\]
	\end{itemize}
\end{defn}
Bye construction it is clear that the essential spectrum consists of
\begin{itemize}
	\item The continuous spectrum
	\item Eigenvalues of infinite multiplicities
	\item Eigenvalues embedded in the continuous spectrum
\end{itemize}

\begin{defn}
	A operator $\Op{A} : D(\Op{A}) \to \hilbert$ on a Hilbert space $\hilbert$
	is \newterm{compact}
	if for any sequence $(x_n)$ that converges weakly in $\hilbert$,
	$\Op{A} x_n$ converges strongly in $\hilbert$.
	% use norm of D(A) in weak convergence and norm of H in strong
\end{defn}

Note: Laplacian and Hydrogen operator are both not compact.
But they are almost.
Most notably for the Laplacian its inverse is compact
and for the Schrödinger operators (which occur in HF)
the point and the continuous spectra are well-separated,
so approximating with the min-max principle is ok.


\begin{prop}
	If $\Op{A}$ is compact:
	\begin{itemize}
		\item $0 \in \sigma(\Op{A})$
		\item $\sigma(\Op{A}) \backslash {0} = \sigma_P(\Op{A}) \backslash {0}$
		\item Only one of these cases is true:
			\begin{itemize}
				\item $\sigma(\Op{A}) = {0}$
				\item $\sigma(\Op{A}) \backslash {0}$ is finite.
				\item $\sigma(\Op{A}) \backslash {0}$ can be described
					as a sequence of points tending to $0$.
			\end{itemize}
	\end{itemize}
	\begin{proof}
		See~\cite[p. 56]{Helffer2013}.
	\end{proof}
\end{prop}

\begin{prop}
	Let $\hilbert$ be a separable Hilbert space and $\Op{A}$ a compact,
	self-adjoint operator on $\hilbert$,
	then $\hilbert$ admits for a Hilbertian basis,
	\ie a basis set $\{ u_k \}_{k \in \mathcal{I}}$ with
	\[ \braket{u_k}{u_l} = \delta_{kl} \quad \forall k,l \in \mathcal{I}. \]
	and
	\[ \text{span} \{ u_k \}_{k \in \mathcal{I}} = \hilbert \]
	\begin{proof}
		See~\cite[p. 60]{Helffer2013}.
	\end{proof}
\end{prop}

\begin{rem}
If $\hilbert$ is finite-dimensional, then all operators are compact,
which has a lot of noteworthy consequences:
\begin{itemize}
	\item Eigenfunctions of any self-adjoint operator are a basis for the
		Hilbert space $\hilbert$.
		Their eigenvalues are real.
	\item All symmetric operators are self-adjoint.
	\item The essential spectrum is empty: There are only discrete eigenvalues
\end{itemize}
\end{rem}

\subsection{The Laplace operator}
% This section should make clear
% The importance of the Sobolev space $H_2$ for quantum mechanics


or alternatively in spherical polar coordinates
as $(r, \theta, \varphi)$ with
\begin{align*}
	r &= \norm{\vec{r}} = \sqrt{x^2+y^2+z^2} & \theta &= \arccos\frac{z}{r} & \varphi &= \arcsin\frac{y}{x}.
\end{align*}




\label{sec:SpectrumLaplace}
Let us consider the $N$-dimensional analogue of the Laplace operator
introduced in \eqref{eqn:LaplaceOperatorHydrogen}.
In Cartesian coordinates it reads
\[ \Delta = \sum_{i=1}^d \frac{\partial^2}{\partial x_i^2}. \]
This operator plays a crucial role in quantum mechanics.
We will see later\todo{refer} that this operator is part of the
kinetic operator of the Schrödinger equation.
For a physical equation we expect that the operator has
real, i.e. measurable, eigenvalues.
This typically requires the operator to be self-adjoint.
In other words from a physical standpoint we would expect
the Laplace operator to have real eigenvalues.

As it turns out,
the Laplacian operator $T_0 = \Delta$ with the domain $D(T_0) = L^2(\R^d)$
does not have \emph{any}
eigenfunctions $u \in L^2(\R^d)$,
not even in the weak sense of distributions~\cite{Helffer2013}.
In other words we are unable to find an eigenfunctions $u \in L^2(\R^d)$
and a $\lambda \in \R$,
such that it holds
\[ \forall \phi \in C^\infty_0(\R^d):  \int_{\R^d}\phi(x) (\Delta u)(x) \D x = \lambda \int_{\R^d} \phi(x) u(x) \D x. \]
Furthermore the Laplacian operator $T_0$ is not self-adjoint.

It turns out that the domain of the operator is the culprit here.
Converse to the problem we posed it is actually possible
to find \emph{for each} $\lambda \in \C$ an eigenfunction from the
slightly different so-called space of distributions $D'(\R^d)$.
This suggests that the construction of an appropriate, related
operator $T_1$, for which we can find an eigenspectrum.
In fact one may do so in a way, that $T_1$ is even self-adjoint
by the means of the \newterm{Friedrichs extension}.
In the particular case we discussed, there are actually
multiple ways to achieve this.
One way assumes a Dirichlet boundary, where the potential
eigenfunctions go to zero
one obtains the restricted domain
$D(T_1) = H^2(\R^d) \cap H^1_0(\R^d)$
for the self-adjoint Laplacian extension.
Unlike for other operators such an extension for the Laplacian
is not unique.
Another construction assuming a Neumann boundary is possible, too.
It again yields a subset of $H^2(\R^d)$ just with an appropriate
so-called trace condition enforcing the derivative to go to zero
at the boundary.
Most notably this implies that only under specification
of the boundary condition the operator has an eigenspectrum.
This is an observation which is true for many operators in quantum mechanics.

If $u \in H^2(\R^d)$ then $\Delta u \in L^2(\R^d)$

\subsection{The Laplace-Beltrami operator on the unit sphere}
\label{sec:SpectrumLaplaceBeltrami}
\nomenclature{$Y_l^m(\theta, \varphi)$}{Spherical harmonic function with angular
momentum quantum number $l$ and azimuthal quantum number $m$}
\nomenclature{$P^{m}_l$}{Associated Legendre polynomial with orders $l$ and $m$.}

In the previous section, we saw that the Laplace operator $\Delta$
is self-adjoint and has hence real eigenvalues provided that
we choose for its domain a subdomain of $D(\Delta) = H^2(\R^3)$.

In this section we want to discuss the solution of Laplace's equation
on the surface of the unit sphere
\[
	\set{S}^2 := \{ \vec{r} \in \R^3 | x^2 + y^2 + z^2 = 1 \}.
\]
For this it is most convenient to consider
the spherical polar coordinate system,
\ie instead of specifying the vector $\vec{r} = (x, y, z)^T$,
we specify the parameters $r, \theta, \phi$ or
\[ \vec{r} = \mm{ r \, \sin \theta \, \cos \phi \\ r \, \sin \theta \sin \phi \\
r \, \cos \theta }. \]
The condition for the unit sphere than reduces to $r=1$

Since the sphere is no longer a Euclidean geometry
but much rather a curved manifold some of the treatment presented
in the previous chapter no longer holds.
Nevertheless an equivalent to the Friedrichs extension can be found
in order to make the Laplace-Beltrami operator
\[ \Delta_{\set{S}^2} u = \frac{1}{\sin \theta} \frac{\partial}{\partial \varphi}
\left( \sin \varphi \frac{\partial u}{\partial \varphi}  \right)
+ \frac{1}{(\sin \varphi)^2} \frac{\partial^2}{\partial \theta^2} u\]
self-adjoint.
\todoil{Insert details}

The above polar expression for the Laplace-Beltrami operator
allows to explicitly solve the equation
\newcommand{\laplaceSphere}{\Delta_{\set{S}^2}}
\[ \laplaceSphere u = \lambda u \]
for eigenfunctions $u$ and eigenvalues $\lambda$,
which results in the spherical harmonics
\[ Y_l^m(\theta, \varphi) = N_{lm} P_l^m(\cos \theta) e^{im\varphi} \]
where $N_{lm}$ is a normalisation constant
and eigenvalues $-l (l+1)$:
\begin{equation}
	-\laplaceSphere Y_l^m(\theta, \varphi) = l (l+1) Y_l^m(\theta, \varphi)
	\label{eqn:Laplace}
\end{equation}
Importantly the quantum number $l$ is positive and $m$ is restricted by
\[ -l \le m \le l, \]
such that there are exactly $(2l+1)$ spherical harmonics with the same eigenvalue
$-l (l+1)$.

For our following arguments it will be important to note
that the 3d Laplacian in spherical polar coordinates
and the Laplace-Beltrami operator for the unit sphere
are related by
\newcommand{\laplaceRadial}{\frac{\partial}{\partial r} \left( r^2 \frac{\partial}{\partial r} \right)}
\begin{equation}
r^2 \Delta = \laplaceRadial + \laplaceSphere
	\label{eqn:LaplaceCorrespondance}
\end{equation}
such that
\begin{equation}
	- r^2 \Delta Y_l^m(\theta, \varphi) = -\laplaceSphere Y_l^m(\theta, \varphi) = l (l+1) Y_l^m(\theta, \varphi)
	\label{eqn:LaplaceSphericalHarmonic}
\end{equation}


\subsection{The Schrödinger operator for a Hydrogenic atom}
\label{sec:HydrogenAtom}
We will discuss in the next chapter the physical origin.
For now we will just state that the Schrödinger operator for the Hydrogenic atom
(in so-called atomic units)
is given by the expression
\begin{equation}
	\Op{H} = - \frac12 \Delta - \frac{Z}{r} = -\frac{1}{2r^2} \laplaceRadial -\frac{1}{2r^2} \laplaceSphere - \frac{Z}{r}
	\label{eqn:HydrogenOperator}
\end{equation}
in other words the scaled Laplace operator and a term for a radial-symmetric Coulombic
potential.

The Hilbert space for this operator is $L^2(\R^3, \C)$
and the domain is $C^\infty_0(\R^3, \C)$
By a similar argument to section \vref{sec:SpectrumLaplace} based on the
Friedrichs extension one notices that this operator is self-adjoint
if the domain is chosen to be $H^2(\R^3, \C$.
Let us now find the analytic expressions of the eigenfunctions of this operator,
i.e. solve the time-independent Schrödinger equation
\begin{equation}
	( \Op{H} - E ) \Psi = 0
	\label{eqn:HydrogenEigenproblem}
\end{equation}
where $\Psi \in L^2(\R^3, \C)$ and $E \in \R$.
\todoil{More details on this later}

Without jumping ahead too far let us assume that both the energy as well
as the state $\Psi$ are characterised by three quantum numbers $n$, $l$ and $m$.
A further careful inspection of \eqref{eqn:HydrogenEigenproblem}
in contrast with \eqref{eqn:Laplace} suggests a product ansatz
\[ \Psi_{nlm}(\vec{r}) = R_{nl}(r) Y_l^m(\theta, \phi) \]
This yields to the radial equation
\begin{equation}
	- \left( \frac{1}{2r^2} \laplaceRadial + \frac{l (l+1)}{2 r^2} - \frac{Z}{r} - E \right) R_{nl}(r) = 0
	\label{eqn:HydrogenRadial}
\end{equation}
which has the solutions~\cite{Mueller2000}
\begin{equation}
	 R_{nl}(r) = N_{nl} \left(\frac{2Zr}{n}\right)^l \exp\left(-\frac{Zr}{n} \right)
\;_1F_1\left(l+1-n | 2l+2|\frac{2Zr}{n}\right)
	\label{eqn:HydrogenRadialSolution}
\end{equation}
where $_1F_1\left(a|b|\zeta\right)$ is a confluent hypergeometric function,
namely~\cite{Avery2006}
\[ _1F_1\left(a \middle| b \middle| \zeta\right) =
\sum_{k=0}^\infty \frac{a^{\bar{k}}}{k! \, b^{\bar{k}}} \zeta^k =
1 + \frac{a}{b} \zeta + \frac{a(a+1)}{2b(b+1)} \zeta^2 + \cdots \]
where $a^{\bar{k}}$ is the rising factorial of $a$.
The normalisaton constant is
\[ N_{nl} = \frac{2 \left( \frac{Z}{n} \right)^{3/2}}{(2l+1)!} \sqrt{ \frac{(l+n)!}{n (n-l-1)!}} \]
The energy eigenvalues are
\[ E_{nlm} = - \frac{Z^2}{2n^2}. \]
\todoil{One should mention that these are all to be found,
	since the radial functions are complete in the radial sense
and the spherical harmonics are complete in the angular sense.}

If one walks through the derivation properly,
one notices that the principle quantum number $n$ is always larger than zero
and that $l < n$ applies as well.
\todoil{If I remember correctly this is a result of Sturm-Liouville theory}
Together with the restrictions on $l$ and $m$ itself this results in the
following restrictions on the quantum numbers:
\begin{align*}
	n &> 0 & 0 \leq l &< n & -l \leq &m \leq l
\end{align*}
Taking a look at the confluent hypergeometric function we use, it is easy to see
that the power of the polynomial in $r$ is between zero and
\[
	\deg \;_1F_1\left(l + 1 -m \middle| 2l+2 \middle| \frac{2Zr}{n} \right) = n - l -1 \]
such that overall the polynomial part of the radial function
has a power between $l$ and
\[ \deg \frac{R_{nl}(r)}{\exp(2Zr/n)} = n - 1. \]

We will now argue that the solutions $\Psi \in H^1(\R^3, \C)$.
It is easy to see that the derivative of $\Psi$ is continuous and bound
everywhere but the origin.
See \cite{Kato1957} and references therein for details.
Since the smoothness at the origin is better the larger
the larger the exponents of the polynomial in $r$,
let us consider the worst case, i.e. the $s$-functions with $l = 0$.
Taking a look at the definition of $_1F_1(a,b,\zeta)$
one notices that the smallest exponent, irrespective of the value of $n$ is $0$.
Thus we will discuss the smoothness properties of
\[
	\Psi_{1s}(r, \theta, \phi) = \Psi_{100}(r, \theta, \phi)
	= \sqrt{\frac{Z^3}{\pi}} \exp(-Z r)
\]
at the origin,
which in fact is the least smooth of all hydrogen solutions.

Since this function is radially symmetric,
we only need to consider the derivative along one direction.
Without loss of generality we choose the $x$ direction.
Taking the first derivative we find
\[
	\frac{\partial \Psi_{1s}}{\partial x} = -\sqrt{\frac{Z^5}{\pi}} \frac{x}{r} \exp(-Z r)
\]
As expected at the origin we encounter a discontinuity in the derivative.
Inserting $x = r \sin\theta \cos \phi$ we do notice
\[
	\lim_{r \to 0} \frac{\partial \Psi_{1s}}{\partial x} = -\sqrt{\frac{Z^5}{\pi}} \sin\theta \cos \phi,
\]
which stays finite.

The second derivative is H1 as well (see Hardy inequality)


The derivative is thus bounded at zero as well
and as a result square-integrable.
On the other hand the second derivative
\[
	\frac{\partial^2 \Psi_{1s}}{\partial x^2}
	= \left( -\frac{Z x^2}{r^2} -\frac{x^2}{r^3} + \frac{1}{r} \right)
		\sqrt{\frac{Z^5}{\pi}} \exp(-Z r)
\]
is unbound at the origin.
Careful inspection shows that it is not square-integrable.
\todoil{Do that}
Therefore $\Psi_{1s} \in H^1(\R^3,\C)$, but $\Psi_{1s} \not\in H^2(\R^3, \C)$.







Show that Solutions are in $H^2$ by considering
the least smooth (i.e. the 1s orbital) and showing that this
is in $H^2$.
That way we know that $H^1$ is a good space for approximating the solutions
$\Rightarrow$ FE formalism can be applied.

\todoil{Try to check whether a productansatz for regularising the nuclear potential
	in combination with CS for the nuclear cusp factor and FE for the rest
could actually work}


% Derivative is smooth and bounded everywhere but at origin
% Argue that the worst function is for l = 0.
% Take derivative wrt. x
% Then show that it's absolute value at the origin just contains a hole
% hence derivative is L^2 integrable in the weak sense


