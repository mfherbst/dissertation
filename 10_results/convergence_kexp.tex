\section{The effect of the Coulomb-Sturmian exponent}
\label{sec:kexp}

In our discussion about the properties of Coulomb-Sturmian basis sets
we have  neglected the effect of the \CS exponent $\kexp$ so far.
Our main argument was that a \CS basis is complete regardless of the
value of $\kexp$,
such that for large enough \CS basis sets
the result will not depend on $\kexp$ anyway.
In practice the aim is of course to yield a sensible
discretisation of the wave function in the smallest basis possible.
For getting the best out of a particular truncated set,
the value of $\kexp$ can therefore not be chosen completely arbitrary.
This section is therefore devoted to a discussion
of some general trends regarding
the variation of obtained energies with $\kexp$.
Furthermore we will discuss some methodologies
for obtaining the optimal exponent $\kopt$ with respect to minimising the \HF energy.
These results will be presented for the
atoms of the first two periods of the periodic table.

\begin{figure}
	\centering
	\includeimage{10_results/EHF_terms_vs_k}
	\caption[
		Plot of the \HF energy contributions
		versus the Coulomb-Sturmian exponent $\kexp$.
	]{
		Plot of the \HF energy contributions
		of the beryllium
		atom versus the Coulomb-Sturmian exponent $\kexp$.
		All calculations are done in a $(5,1,1)$ \CS basis.
	}
	\label{fig:EnergyTermsVsK}
\end{figure}

In the \CS basis functions
$\kexp$ only occurs in the radial part \eqref{eqn:RadialPartCsRepeated}.
In the form of the exponential term $\exp(-\kexp r)$
it influences how quickly the basis functions decay at infinity
and in the form of the polynomial prefactor it determines
the curvature of the radial functions as they oscillate between the radial nodes.
Keeping this in mind let us consider figure \vref{fig:EnergyTermsVsK},
which shows the changes to individual energy contributions
of the \HF ground state energy as $\kexp$ is altered.
The largest changes are apparent for the nuclear attraction energy,
which decreases --- initially rather steeply --- as $\kexp$ is increased.
This can be easily understood from a physical point of view:
Since larger values of $\kexp$ imply a more rapid decay
of the basis functions,
the electron density on average stays closer to the nucleus,
which in turn leads to a lower (more negative) interaction energy
between electrons and nucleus.
The converse effect happens for smaller values of $\kexp$,
where the electron density is more expanded
and thus on average further away from the nucleus.
On the other hand the kinetic energy is related to the curvature of the wave function,
which --- as described above --- increases for larger $\kexp$.
In other words the trends of nuclear attraction energy and electronic kinetic energy
oppose each other,
with the kinetic energy being somewhat less effected.
On the scale depicted in figure \ref{fig:EnergyTermsVsK}
the variation of the electron-electron interaction,
\ie both classical Coulomb repulsion as well as the exchange interaction combined,
is much less pronounced.
Only a very minor increase with $\kexp$ can be observed.
The physical mechanism is again similar to the nuclear attraction
energy term,
namely that larger $\kexp$ compresses the wave function
and thus leads to the electrons reside more closely to another,
which increases the Coulomb repulsion between them.
The exchange interaction is effected as well,
but the changes are smaller and thus not visible.

\begin{figure}
	\centering
	\includeimage{10_results/Efci_vs_k}
	\caption[
		Plot of the \HF, {\MP}2 and \FCI energies
		versus the Coulomb-Sturmian exponent $\kexp$.
	]{
		Plot of the \HF, {\MP}2 and \FCI ground state energies
		of beryllium
		versus the Coulomb-Sturmian exponent $\kexp$.
		The optimal exponent $\kopt$ for each
		method is marked by a cross.
		All calculations are done in a $(5,1,1)$ \CS basis.
	}
	\label{fig:FCI_vs_k}
\end{figure}
Summing up all energy contributions leads to the blue curve
in figure \vref{fig:FCI_vs_k},
which shows the total Hartree-Fock energy versus
the Coulomb-Sturmian exponent $\kexp$.
From our discussion of the individual terms
it is apparent that at small values for $\kexp$
the increase in nuclear attraction energy dominates,
such that the \HF energy increases rapidly.
At large distances the kinetic energy and electron-electron
interaction terms win, such that a convex curve
for the plot $E_\text{HF}$ versus $\kexp$ results.
Adding correlation effects by a treatment of the atom at {\MP}2 or \FCI level,
does not change this overall behaviour much.
Up to a large extend the curves are just shifted downwards by the
correlation energy term.
The shift is, however, not completely uniform.
This can be seen if we consider the optimal \CS exponent $\kopt$,
which is denoted by a cross in each of the plots of figure \ref{fig:FCI_vs_k}.
This exponent of minimal energy shifts
to slightly larger values going from \HF to {\MP}2 and finally to \FCI
indicating that the amount of correlation energy is somewhat larger
at exponents slightly above $\kopt$ for Hartree-Fock.
Notice that $\kopt$ not only depends on the method used for modelling
a particular state,
but it well depends on the state as well.
For example for modelling the first $T1$ excited state of beryllium
a smaller value for $\kopt$ is obtained than the \FCI $\kopt$
of the depicted $S0$ ground state.

\begin{figure}
	\centering
	\includeimage{C_ene_gs_vs_k}
	\caption[
		Dependency of the \HF and {\MP}2 energies
		on the \CS exponent $\kexp$
		and the basis set
	]{
		Plot of the unrestricted
		\HF and {\MP}2 ground state energies of carbon
		versus the Coulomb-Sturmian exponent $\kexp$
		in the $(4,2,2)$, $(5,2,2)$ and $(6,2,2)$ basis sets.
		The optimal exponent $\kopt$ at \HF level
		for each basis set is marked by a cross.
	}
	\label{fig:EHF_vs_k}
\end{figure}

Since $\kexp$ only occurs in the radial part of the \CS basis functions
the effect of its variation depends on the
maximal principle quantum number $\nmax$ of the basis set.
As larger and larger values of $\nmax$ are used,
the discretisation of the radial part of the wave function
becomes more and more complete,
such that the choice of $\kexp$ in turn becomes less important.
Figure \vref{fig:EHF_vs_k} shows this for the ground state energy of the carbon atom
at unrestricted \HF and {\MP}2 level.
Whilst a $(4,2,2)$ \CS basis reproduces largely the
shape of the plots in figure \ref{fig:EHF_vs_k},
for $(5,2,2)$ and $(6,2,2)$ the energy versus exponent curves
become visibly flatter close to the optimal exponent (around $\kexp = 2.8$).
The influence of increasing $\nmax$ is not the same
for all values of $\kexp$.
Instead the curves seem to bend down in the range $\kexp > 3$.
In other words choosing a \CS exponent larger than $\kopt$
will generally speaking lead to a smaller error
than choosing a too large exponent%
\footnote{We already noted this aspect in the context of discussing
	the local energy plots in section \vref{sec:BasisCS}.}.
Another conclusion we can draw from figure \ref{EHF_vs_k}
is that the optimal value for the exponent $\kopt$
depends on $\nmax$ as well
as larger basis sets give rise to smaller values for $\kopt$.
We can rationalise by taking the plots of the energy terms
in figure \vref{fig:EnergyTermsVsK} into account.
We already noticed above that the nuclear attraction energy
is influenced by $\kexp$ most strongly.
Additionally it is (by magnitude) the largest contribution to the \HF energy.
In order to yield the minimal ground state energy
in a small basis the dominating effect is therefore to
minimise the nuclear attraction energy as much as possible.
As a result the optimal exponent $\kopt$ takes comparatively large values.
As the basis becomes larger a balanced description
of the complete physics becomes possible,
such that the electron repulsion and kinetic energy terms
are described better as well
and thus smaller values for $\kopt$ result.

Due to the structure of the energy versus exponent curves,
like the ones shown in figure \vref{fig:EHF_vs_k},
one hardly ever needs to know $\kopt$ very accurately.
As long as one uses a reasonable guess,
which is constructed to overestimate $\kopt$
rather than underestimate it, one is usually safe.
If a highly accurate treatment of a particular system is required,
then increasing $\nmax$ has both a much larger effect
and is computationally cheaper than finding the optimal exponent in the smaller basis.
See the next section for details.
% overestimating plays in line with correlated treatment,
% where $\kopt$ becomes larger due to the correlation.

% TODO OPTIONAL
%\begin{figure}
%	\centering
%	\includeimage{C_hfterms_vs_k}
%	\caption{HF energy terms vs $\kexp$ for different basis sets}
%	\label{fig:Eterms_vs_k}
%\end{figure}
%
%In figure \vref{fig:Eterms_vs_k} we observe the same trends
%as in figure \vref{fig:EnergyTermsVsK} for beryllium
%just with the difference that
%the result is shown for different basis sets.
%We observe that the trends get smaller if larger basis sets are chosen.


% TODO OPTIONAL
%\begin{figure}
%	\centering
%	\includeimage{C_orben_622_vs_k}
%	\caption{E orbital vs k, only alpha orbitals are plotted of 622}
%	\label{fig:orben_vs_k}
%\end{figure}
%
%The interpretation of the orbital energy vs $\kopt$ curve
%should be done with care.
%For this note that the minimal sum of the orbital energies
%occurs at a much smaller value for $\kopt$,
%since the electron-electron interactions are counted twice
%hence shifting the optimal value for the sum of the orbital
%energies more towards smaller $\kexp$.
%
%Nevertheless it allows us to qualitatively assess the realisation
%that for the description of the virtual or valence states
%smaller $\kopt$ values are preferable whilst for the core states
%larger $\kopt$ are typically preferred.
%Again since the core-like orbitals have a bigger contribution
%to the energy typically small basis sets tend to try to represent
%these in a good fashion first, hence tending to larger values of $\kopt$.
%Whilst the $\kopt$ decreases as the basis gets larger up to the point
%where its precise value becomes less and less important.


%
% ----------------------------------------------------------
%
\subsection{Determining the optimal exponent $\kopt$}
For variational quantum-chemical methods finding the best Coulomb-Sturmian
exponent $\kopt$ for the ground state is equivalent to minimising the ground state
energy with respect to $\kexp$.
Since such energy curves are
convex~(compare figures \ref{fig:FCI_vs_k} and \ref{fig:EHF_vs_k})
and only scalar functions of a single parameter,
this minimisation can be performed quite effectively
by gradient-free optimisation algorithm such as Brent's method~\cite{Brent1972}.
Starting from a reasonable guess for $\kopt$ convergence to the minimum
is usually achieved in around $10$ iterations.
For achieving this Brent's method will require a similar number of
energy computations using the chosen quantum-chemical method
and the chosen \CS basis.

With respect to the basis, which is used for such a procedure,
there are two things to note.
Firstly we already mentioned in our previous discussion
that $\kexp$ is a parameter,
which only affects the radial part.
In other words for obtaining a situation in which the individual
calculations of the energies
are not dominated by the error in the angular discretisation,
but the current value of $\kexp$,
large enough values for  $\lmax$ and $\mmax$ should be chosen.
Too large values of $\lmax$ will, however, lead to large basis sets,
thus long run times for the energy calculations.
In practice a compromise between accuracy and runtime needs to be found.
Our investigations~(see tables \ref{tab:Kopt2} and \vref{tab:Kopt3})
seem to suggest that one can find reasonable values for $\kopt$
already for basis sets where $\lmax$ is chosen smaller than
the value suggested by the $\RMSOl$ plots.
Secondly one should keep in mind that too large values of $\nmax$
will cause the energy-vs-$\kexp$ curves to become flat around $\kopt$,
which slows down convergence of the optimisation procedure.
Keeping in mind that typically getting \emph{roughly} the
right value for $\kopt$ is good enough,
it is sometimes more sensible to find $\kopt$ in a smaller
basis set,
where the energy-vs-$\kexp$ is more steep and calculations are faster,
and use this value for larger basis sets as well.
For the reasons we discussed in the previous section
such a $\kopt$ from a smaller basis
will always be an \emph{overestimation} of the actual $\kopt$,
which is favourable.

Our investigations have so far only considered
obtaining optimal exponents $\kopt$ at \HF level.
The most challenging aspect for doing so is in fact the stability of the
\SCF procedure itself.
Especially at the beginning of the iteration,
when the Coulomb-Sturmian exponent $\kexp$ is still relatively
far off the optimal value, the core Hamiltonian guess%
\footnote{So far only random guesses, guesses from previous \SCF cycles
	and core Hamiltonian guesses are implemented in \molsturm.}
we employ by default is not very good and frequently
fails to lead to the true \SCF minimum in our \SCF scheme.
Much rather another stationary point on the \SCF Stiefel manifold is found.
If we now continue to use the resulting wrongfully converged \SCF coefficients
as the guess for the next iteration of Brent's method,
we will typically manage to find a $\kopt$,
but this might not be the $\kopt$ of the true \SCF minimum,
\ie the true \HF ground state.
On the other hand if we start from the core Hamiltonian guess each time,
it can happen that the \SCF iterations for different values of $\kexp$
lead to different stationary points on the Stiefel manifold.
This violates a fundamental assumption of Brent's method,
namely the continuity of the objective function.
In other words the optimisation procedure is likely to find
a wrong value for $\kopt$ in this case.

Our remedy is to first make very sure we obtain a reliable
guess for starting the \SCF procedures called during the optimisation
before starting the optimisation procedure energy versus $\kexp$ at all.
In order to do so
we first perform $5$ {\SCF}s starting from totally random guesses
for the input value of $\kexp$ supplied by the user.
From the lowest-energy result of these we then
take the orbital energies $\varepsilon_i$
and use them to estimate a second value for $\kexp$, namely
\begin{equation}
	\kexp \simeq \sqrt{\frac{-2}{\Nelec} \sum_{i\in\Iocc} \varepsilon_i}.
	\label{eqn:KoptHfEstimate}
\end{equation}
The rationale for this heuristic formula is
the energy-dependent decay of the exact wave function~\cite{Kato1951},
which --- assuming \HF to be exact --- would manifest as well in an
energy-dependent decay of the orbitals by themselves.
Applying the formula
\[ \varepsilon_i = - \frac12 k_i \qquad \Leftrightarrow \qquad k_i
	= \sqrt{-2 \varepsilon_i}
\]
to yield the best exponent $k_i$ for describing orbital $i$ and taking the average
over all $k_i$ results in \eqref{eqn:KoptHfEstimate}.
The result from applying \eqref{eqn:KoptHfEstimate} is typically not extremely good,
but in the cases we considered it is at least in the same order of magnitude
as the final $\kopt$,
such that this estimate is easy to compute and corrects for the cases,
where the user's guess was very far off.
For this second $\kexp$ we perform another $5$ \SCF iterations
starting completely from random guesses.
From all $10$ obtained \SCF ground states,
both the $5$ with the $\kexp$ supplied by the user and the $5$ with the $\kexp$
from \eqref{eqn:KoptHfEstimate},
we only keep the solution, which has the lowest \HF energy.
For \emph{all} {\SCF}s which are started during the
subsequent energy versus $\kexp$ optimisation
this solution is used as the initial guess.
In this way all inner {\SCF}s approach the \SCF procedure
from the same reliable guess,
which largely avoids discontinuities in the \HF energies
and thus directs Brent's method to a sensible value for $\kopt$.

This algorithm for finding $\kopt$ is not cheap,
since around 20 to 30 complete {\SCF}s are required for convergence.
It is, however, reliable and allowed us to obtain optimal exponents
for a range of basis sets for all atoms of the second and third period.
These results are shown in tables \vref{tab:Kopt2} and \vref{tab:Kopt3}.
For convenience this procedure is implemented in \molsturm
and can be called from \python using the function
\texttt{find\_kopt} from the module \texttt{molsturm.sturmian.cs}.
\molsturm also offers the function \texttt{empirical\_kopt}
as a cheaper empirical estimate for $\kopt$.
It is based on interpolations using the values from
tables \ref{tab:Kopt2} and \ref{tab:Kopt3}.
Currently it can thus only be used for atoms of the second and third period.

%
% ----------------------------------------------------------
%
\subsection{Interpretation of the optimal exponent}
\todoil{TODO}
\label{sec:ValuesKopt}

In his \citeyear{Slater1930} paper \citet{Slater1930} introduced
the concept of a shielding parameter $\sigma$ in order to
describe the atomic orbitals by simple analytic expressions of the form
\begin{equation}
	\chi_{n^\ast, \sigma} = r^{n^\ast - 1} \exp\left( - \frac{(Z - \sigma)r}{n^\ast} \right)
	\equiv r^{n^\ast - 1} \exp\left( -\zeta r\right),
	\label{eqn:SlaterShielding}
\end{equation}
which are now used as basis functions for quantum-chemical
calculations under the term Slater-type orbitals~(see section \vref{sec:STO}).
In the context of introducing the Coulomb-Sturmians
in section \vref{sec:BasisCS}
we already indicated the similarity of Slater-type orbitals
and the Coulomb-Sturmians.
Essentially the Slater exponent $\zeta$ and the \CS exponent $\kexp$
play the equivalent roles,
but with the subtle difference that for \CS basis sets all functions
need to carry the same exponent.

In his original work Slater already provided rough guidelines for
estimating the shielding parameter and thus the exponent $\zeta$.
Later this work was picked up by \citet{Clementi1963},
who determined optimal values for $\zeta$ by performing \HF calculations,
variationally optimising $\zeta$ to yield the lowest \HF energy.
For clarity we will refer to their optimal exponents as
$\zeta_\text{Clementi}$ in this section.

\begin{figure}
	\centering
	\includeimage{10_results/kopt_vs_atnum}
	\caption[
		Plot atomic number versus the optimal Coulomb-Sturmian exponent
	]{
		Plot of the atomic number versus the optimal Coulomb-Sturmian exponent
		$\kopt$ for the neutral atoms of the second and the third period.
		For comparison the occupation-averaged value of the \citet{Clementi1963} optimal
		Slater exponent $\zeta_\text{Clementi}$ as well as the
		value $\zeta_\text{Clementi}$ for the highest occupied orbital~(HO)
		are shown.
	}
	\label{fig:KoptVsAtnum}
\end{figure}
The procedure of \citeauthor{Clementi1963} to determine $\zeta_\text{Clementi}$
and our procedure followed to find $\kopt$ bears a lot of resemblance.
As such it should not come to a surprise that the behaviour of $\kopt$
along the periodic table is related to
the behaviour of $\zeta_\text{Clementi}$ as well.
This result is summarised in figure \vref{fig:KoptVsAtnum},
which shows the optimal Coulomb-Sturmian exponents
as well as two values related to $\zeta_\text{Clementi}$
for the neutral atoms across the second and the third period of the periodic table.
One value is the exponent $\zeta_\text{Clementi}$ for the HO,
the highest occupied orbital, of the atom
whilst the other is the occupation-averaged value of $\zeta_\text{Clementi}$
for each atom.
Due to the fact that all Coulomb-Sturmians share the same exponent
the value of the optimal exponent $\kopt$ is much closer to the
averaged $\zeta_\text{Clementi}$ values
than to the $\zeta_\text{Clementi}$ of the HO or any other orbital alone.

% ----

Over the period $\kopt$ follows a roughly linear trend,
where the increase is less steep in the third period compared to the second.
We can understand that by considering once again
that $\kopt$ gives an average over all orbitals.
Since especially the low-energy orbitals close to the nucleus
are shielded very little,
their value of $\kopt$ increases constantly along the periodic table.
The $\kopt$ for the valence orbitals, however, changes much more.
Especially at the beginning of the period, where atomic radii are large,
the $\kopt$ for the valence orbitals are small,
whilst this changes as the atoms get smaller across the period
and hence $\zeta_\text{Clementi}$ and $\kopt$ get larger.
This effect is diminished, however,
by the constant $\kopt$ increase of the
much larger number of core-like orbitals
and thus the rate of change of $\kopt$ across a period gets smaller,
the slope thus smaller as well.
Furthermore this implies that the rapid $\kopt$ change
going from one period to the next (e.g. Ne to Na)
will get smaller and smaller as well
as the effect of the valence-like orbitals gets averaged out.

% ----


Note that by Slater's original definition,
we can identify the relationship
\[ Z_\text{eff} = n^\ast \zeta_\text{Clementi} \]
between the effective nuclear charge $Z_\text{eff}$ and
the optimal exponents $\zeta_\text{Clementi}$~\cite{Slater1930},
where $n^\ast$ is a function of the quantum number $n$ of the orbital
under consideration.
By means of a similar rationale to what has been sketched above,
we can therefore find a chemical interpretation for $\kopt$,
namely that it gives an understanding of the average
charge which is felt by the orbitals of a particular atom
or in other words the average shielding which takes place in the atom.
\todoil{Can one state it like that?}

% ---


An alternative way of viewing this is
that as a new shell becomes occupied it requires
the representation of an extra (more expanded) orbital.
So initially $\kexp$ gets reduced.
As we move across the period the nuclear charge increases
and since the shielding abilities of electrons in the same shell
is not that strong the orbitals become more contracted and occupy less space
thus $\kexp$ increases again.
As we move to larger periods this effect of change is averaged out
again by the more constant core-like orbitals.


\include{table_kopt}
