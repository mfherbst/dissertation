\chapter{Prospects and further work}
\label{ch:Prospects}
\chapquote{%
Humanity needs practical men,
who get the most out of their work, and,
without forgetting the general good,
safeguard their own interests.
But humanity also needs dreamers,
for whom the disinterested development of an enterprise is
so captivating that it becomes impossible for them to devote
their care to their own material profit.}
{Marie Skłodowska Curie~(1867--1934)}

\noindent
With the availability of the \molsturm program package in its
current state a flexible research tool
for the development and the investigation of novel quantum-chemical methods
has become available.
Especially the aspect to quickly incorporate third-party packages
for performing Post-Hartree-Fock~(Post-\HF) methods
or to link to new integral back ends
opens the door for many further research directions.
But also on the level of the algorithms and data structure used
inside \molsturm further improvements can be achieved.
Most prominently, the \lazyten lazy matrix library is only
in a preliminary state right now,
where not all aspects of the lazy matrix concept have been implemented
and performance improvements are definitely possible.
This chapter will present a few ideas for further research directions
and gives some hints how these could be achieved in the future.

\section{Generalisation of \lazyten}
\label{sec:GeneraliseLazyten}
The lazy matrices of \lazyten are a key component of \molsturm,
being both the language in which the self-consistent field~(\SCF)
algorithms are implemented
as well as the data structure
mediating the call to the integral back end libraries.
Many performance improvements of \lazyten will therefore
directly affect \molsturm as well and are thus worth pursuing.
Additionally \lazyten is a package by its own,
such that all aspect mentioned here could make it more
applicable to a broader context than just
quantum-chemical method development.

Currently the \lazyten library is limited to lazy matrices,
which implies that it only supports the implementation of algorithms
involving matrix-matrix and matrix-vector operations.
As soon as higher-order tensor contractions are required,
these need to be hidden inside the contraction expression.
Effectively this implies
that they are either to be implemented manually
or by explicit appropriate calls to some linear algebra package.
Already at the level of the \SCF of \molsturm we run into this limitation,
namely when we form the Coulomb matrix $\mat{J}$
and the exchange matrix $\mat{K}$ from the electron repulsion integral~(\ERI) tensor
$\eriMu{\mu\nu}{\kappa\lambda}$, see equations \eqref{eqn:Jbas} and \eqref{eqn:Kbas}.
We have solved this right now by implementing two
hard-coded contraction schemes of the \ERI tensor with
the coefficient matrices in the required manner to form $\mat{J}$ and $\mat{K}$,
which is certainly not ideal.

In the future such issues could be tackled
by extending \lazyten towards lazy tensors as well.
Similarly to lazy matrices,
such lazy tensor objects would no longer be directly mapped to flat data,
but allow the encapsulation of arbitrary expressions
for computing contractions with itself or other tensors.
For the evaluation of operations between lazy tensors
again a lazy evaluation scheme would be employed,
such that the contraction between tensors would first be
stored as a tensor expression tree to be evaluated at a later point.

Undoubtedly already the design of such a library is challenging
and would probably needed to be performed in steps,
gradually generalising the lazy matrix concept towards them.
Another question is how to find a suitable evaluation
scheme for dealing with the arising expression tree.
Some work in this direction has already been performed by others,
both in the context of quantum-chemical calculations
as well as in general~\cite{Baumgartner2005,Peise2015,Xerus,Kristensen2016array,Kristensen2016streaming}
\todoil{Cite CTF, tiledarray, libtensor}
and the hope is to incorporate or reuse some of these aspects.
A good first step in either case would be an even closer integration
with the Bohrium~\cite{Kristensen2016array,Kristensen2016streaming} package,
such that their efforts for optimising the performance
of array operations could be used as much as possible.

The prospect of the proposed ansatz is to construct a domain-specific language
for contraction-based algorithms,
which can be implemented by writing high-level code
resembling physical formulae as much as possible,
just like the CCD code presented in figure \ref{fig:codeCCD}
of section \ref{sec:ex:ccd}.
In line with the lazy matrices the advantage of such a
generalisation would be that the computational details
are well-separated from the user code,
allowing for a dynamic change of algorithms
reacting to the requirements of basis function types
or the hardware the program runs on.
This would include the theoretical option to generate all data required for tensor
contractions on the fly and without storing anything in memory.

\section{\molsturm program package}
After two years of development,
\molsturm is in a state,
where calculations based on contracted Gaussian basis sets
and Coulomb-Sturmian basis sets can be performed.
Furthermore, as mentioned in section \vref{sec:MolsturmState}
and demonstrated in chapter \vref{ch:CSQChem},
not only \HF, but Full-CI(\FCI) and
methods based on the algebraic-diagrammatic construction scheme(\ADC)
are available
via interfaces to \pyscf~\cite{Sun2017} and \adcman~\cite{Wormit2014}.
For properly employing these Post-\HF features on more than
very simple test calculations
a major drawback at the moment is performance
at the level of the \SCF as well as the level of the interface itself.

To some extend the improvements
of \lazyten directly lead to angles for tackling these problems as well.
For example a generalisation of \lazyten to lazy tensors
would allow to use lazy tensors as data structures on the level of \molsturm's
interface as well.
Right now this is prevented by the \ERI tensor,
which --- as indicated above --- cannot be represented as a lazy matrix,
such that a costly step of copying all data from the internal
representation to the data structures of the interface results.
On the level of the \SCF the automatic parallelisation
of the evaluation of the lazy matrix expression trees
would help to improve the efficiency.

\subsection{Reliable contraction-based self-consistent field algorithm}
So far none of the \SCF algorithms available in \molsturm
are perfectly reliable and frequently the implemented \SCF scheme
amounts to find stationary states of the \HF problem,
which are not the true \SCF minimum.
Remedies could be to implement more sophisticated algorithms like
the energy \DIIS~\cite{Kudin2002}
or a second-order \SCF scheme~\cite{Salek2007,Hoest2008}
inside the \contraction-based setting of \molsturm.

\subsection{Interfaces to further quantum-chemistry packages}
\label{sec:ExtensionInterfaces}
Given the modular structure of \molsturm
interfacing to further quantum-chemistry libraries or program packages
can likely be achieved in the future to extend the scope of the package.
A good example is the \texttt{libxc}~\cite{Lehtola2018} library,
which offers a range of exchange-correlation functionals.
Implementing an interface to this library inside appropriate
lazy matrix objects would allow to construct the Kohn-Sham matrix
inside \molsturm's \contraction-based \SCF as well,
such that density-functional theory calculations
could be performed.
Furthermore a better link to \pyscf~\cite{Sun2017}
would allow to perform configuration-interaction,
coupled-cluster and density matrix renormalisation group
using this library directly from \molsturm.
The modular structure of \psifour makes it another good candidate
for quickly extending the number of available methods
on top of \molsturm's \SCF.
On top of that data exchange with existing quantum-chemistry-related softwares
could be simplified by supporting some wide-spread file formats in \molsturm,
\eg \texttt{MolPro}'s FCIDUMP~\cite{Knowles1989},
the \texttt{molden}~\cite{Schaftenaar2000} format
as well as routines for dumping plotting data
in \texttt{Gaussian}~\cite{Frisch2016} cube or VTK~\cite{Avila2010} files.
% TODO OPTIONAL
% \subsection{Partial rewrite in \python}

\section{Investigation of Sturmian-type discretisations}
The original purpose of the \molsturm package has been to devise a program
which could be used for quantum-chemical calculations
employing Sturmian-type basis functions,
which are a category of analytic solutions to Schrödinger-like equations.
The package has outgrown this purpose in the current design,
but investigating the properties of Sturmian-type basis functions is still of interest
as they are rarely used for quantum-chemical calculations so far.

\subsection{Convergence properties of Coulomb Sturmian basis sets}
The simplest example for Sturmian-type basis functions are Coulomb-Sturmians.
An initial investigation of such basis functions presented
in chapter \ref{ch:CSQChem} looks overall promising,
but the obtained results are not yet sufficient to provide definitive
construction schemes for \CS basis sets
or general estimates for the overall accuracy.
There are three ways this could be improved.

Firstly so far only main group elements of the second and third
period of the periodic table were considered.
Originating from the involvement of the $d$-orbitals
the properties of the electronic structures of the transition metals does, however,
differ compared to the main group elements.
An analysis with respect to the fourth period and beyond
is therefore required to reach more general conclusions.

Secondly most of the presented investigation has concentrated on the \HF
level with some minor modifications suggested based on {\MP}2 results.
Whilst these two methods are certainly used in electronic structure theory,
more methods should be added to reach a representative set.
Most notably {\MP}2 as a perturbative approach
for modelling electron correlation effects
is very different from
configuration-interaction-based
or coupled-cluster-based approaches
--- both with respect to the way the physics is described
as well as the numerics.
Further convergence studies for example employing the latter kind of methods
would be required.

Thirdly the full flexibility towards constructing \CS basis sets has not yet
been exploited in our discussion in section \vref{sec:CSconvergenceHF}.
There is no reason why one should define a basis set
by limiting the angular quantum numbers $l$ and $m$ to the same maximum for all
principle quantum numbers $n$.
As mentioned in section \vref{sec:DenotingCSbasis} a \CS basis set can be any
combination of the quantum number triples $(n, l, m)$,
such that, for example, keeping the full range of $l$ and $m$
up to $n=5$ and then only up a maximum of $l=2$ is possible
and should definitely be tried.
With respect to this it would also be interesting to compare the
observed convergence properties with the typical construction schemes
employed for contracted Gaussian~(\cGTO) basis sets~\cite{Jensen2013,Hill2013}.
Potentially the schemes employed in the \cGTO setting are applicable
to \CS basis sets and vice versa.

In general a detailed comparison of the results obtained
from employing Coulomb-Sturmians as well as \cGTO discretisations seems appropriate.
An interesting questions is for example the required basis sizes for both
discretisation types to reach a certain accuracy
in the description of the ground or excited-state energies
at various levels of theory.

\subsection{Coulomb-Sturmian-based excited states calculations}
In section \vref{sec:SturmianADC} we already presented
first results for computing excited state energies of atoms based on \ADC.
A more detailed analysis of the convergence properties
could help to proceed with the application of \CS-based \ADC
calculations in order to compute the spectra of atoms.
Originating from the completeness of the Coulomb-Sturmians
at least three interesting applications in the context of modelling
excitation processes come to mind. Namely
(1) methods where the continuum needs to be modelled,
like Fano-Stieltjes~\todo{cite},
(2) cases where modelling both the core and the valence shell is required,
like core-valence excitations~\todo{cite},
(3) the modelling of expanded bound states,
like the determination of Rydberg-like states~\todo{cite}.

\subsection{Avoiding the Coulomb-Sturmian exponent as a parameter}
An unfavourable aspect of the \CS basis sets
employed in chapter \ref{ch:CSQChem} of the thesis is
the Coulomb-Sturmian exponent $\kexp$.
As was discussed in section \ref{sec:kexp}
this parameter has indeed an influence on the results obtained
and thus needs to be set to a sensible value to obtain sensible results.
If not, than unphysical behaviour can result.
In my calculations I have, for example, found cases
where changing $\kexp$ could change the obtained \SCF minimum
for \HF.
Furthermore there is some indication,
that the ordering of excited states in \ADC calculations
depends on $\kexp$ in some cases.
Using the algorithm described in section \ref{sec:DetermineKopt},
a route for finding an optimal value at \HF level has been sketched.
With respect to excited states methods like \ADC,
it is not immediately obvious how to determine the most optimal exponent,
since the value for describing the ground state with the least error
will differ from the value for representing a particular excited state best.
In turn each excited state will have a different $\kexp$
to give the best description in a particular \CS basis.
Which value or which combination of the values should be taken
is not directly clear.

\noindent
An equivalent problem at \FCI level can be avoided.
The reason is that the relationship
\[ E = - \frac{\kexp^2}{2}, \]
between the \CS exponent $\kexp$ and the energy $E$ of a particular state,
can be employed to re-formulate \FCI in terms of the
Coulomb-Sturmian exponents~\cite{Avery2006}.
In other words instead of solving for the energy of a state,
one solves for the $\kexp$ for each state
and uses this value both to find the corresponding energy
as well as the exponent of the basis functions,
when properties for such a state are to be computed.
A similar reformulation should be possible for \HF
and potentially even for some other Post-\HF methods as well,
even though this is uncertain at the moment.
If this could be achieved both the determination of an optimal
$\kexp$ would become obsolete at \HF level
and for excited states $\kexp$ would adapt automatically to the required state.

\subsection{Molecular Sturmians}
The implementation of a \CS-based \SCF scheme was always intended
to be only the first step with respect to the exploration
of Sturmian-based quantum-chemical calculations.
More general and at the same time more challenging types of Sturmian basis
functions exist,
which are able to describe molecular systems, for example.
Building on recent advances in the calculation of the \ERI integrals
\eqref{eqn:ERI} for such generalised Sturmian-type orbitals%
~\cite{Avery2006,Avery2011PhD,Avery2011,Morales2016,Avery2017,Randazzo2015,Granados2016}
a Sturmian-based \HF suitable for molecular calculations is within reach
and could be implemented within \sturmint~\cite{sturmintWeb}, thus \molsturm.

\section{Finite-element-based quantum chemistry}
At the beginning of my doctoral studies I already attempted
unsuccessfully to implement a \HF scheme based on finite-elements,
a piecewise polynomial basis based on a real-space grid,
see section \vref{sec:FE}.
Recent advances of the field~\cite{Frediani2015,Toivanen2015,Davydov2015,Boffi2016}
seems promising and
implementing a grid-based basis into \molsturm
would an interesting test case with respect to the aspired generality
of \molsturm's \SCF scheme.
A link to the finite-element library \texttt{deal.ii}~\cite{Arndt2017}
could provide the relevant back end to perform the computations.

% TODO OPTIONAL
%Last but not least the ability to treat different kinds of basis functions
%in the same framework simplifies the construction of hybrid basis sets,
%where possibly numerical basis functions and GTOs or STOs are combined.
%Similarly one could employ the strengths of multiple backends for the same type of basis function
%in the sense that one mixes and matches different backends such that one can exploit
%the advantages of both implementations best.

\section{Fuzzing of integral back ends}
The common-ground \SCF of \molsturm where existing integral libraries
can be easily incorporated,
opens for the possibility to test the correctness
of existing integral libraries by comparing the results of
random or semi-random \SCF calculations based on different integral libraries
against another.
Due to the \python interface of \molsturm such a process could
even be completely automatised.
Such fuzzing approaches have already been applied with huge success
in the context of hardening security-critical software~\cite{Fuzzing}
and could be used as a tool to automatically discover bugs
in quantum-chemical software such as integrals library as well.
