\subsection{Contracted Gaussian-type orbitals}
\label{sec:cGTO}

In \citeyear{Boys1950} \citeauthor{Boys1950} suggested to replace
the exponential factor $\exp(- \zeta r)$ in the radial part \eqref{eqn:STOradial}
by a Gaussian factor $\exp(-\alpha r^2)$ instead,
resulting in the so-called Gaussian-type orbitals~({\GTO}s).
Such \GTO basis functions still follow the ansatz radial part times real-valued spherical harmonic
\eqref{eqn:ACproduct}
\begin{equation}
	\varphi^\text{GTO}_\mu(\vec{r}) = R^\text{GTO}_\mu\!\left(\norm{\vec{r} - \vec{R}_\mu}\right)
	\, Y_{l_\mu}^{m_\mu}(\theta, \phi),
	\label{eqn:ACproduct}
\end{equation}
but their radial part is given as
\begin{equation}
	R^\text{GTO}_\mu(r) = N_\mu r^{l_\mu} \exp(-\alpha_\mu r^2)
	\label{eqn:GTOradial}
\end{equation}
with Gaussian exponent $\alpha_\mu$ and normalisation constant
\[
	N_\mu =  \sqrt{\frac{2^{l+2}}{(2l+1)!!}} \, \sqrt[4]{\frac{(2\alpha)^{2l+3}}{\pi}}
\]
This rather \textit{ad hoc} replacement allows to perform the
evaluation of the integrals involved in building the Fock matrix $\mat{F}$
much more efficiently.
Because of the \newterm{Gaussian product theorem}%
~\cite{Boys1950,Szabo1996,Besalu2011},
the product of two Gaussians may be expressed \emph{exactly} as
\[
	R^\text{GTO}_\mu\!\left( \norm{\vec{r} - \vec{R}_\mu}\right)
	\,
	R^\text{GTO}_\nu\!\left( \norm{\vec{r} - \vec{R}_\mu}\right)
	= R^\text{GTO}_\kappa\!\left( \norm{\vec{r} - \vec{R}_\kappa}\right)
\]
where $l_\kappa$, $\alpha_\kappa$ and $\vec{R}_\kappa$ are chosen appropriately.
This allows to evaluate certain integrals
like the \ERI integrals \eqref{eqn:ERI} involving only
$s$-like Gaussian basis functions (where $l_\mu=0$) analytically.
The other  \ERI integrals with higher angular momentum can then be computed by
employing a set of recursion formulas~\cite{Gill1994}.
Similar things hold for the one-electron integrals involved in building
$\mat{T}$ and $\mat{V}_0$,
making the construction of $\mat{F}$ overall much more
feasible for larger basis sets compared to large sets of {\STO}s.

Unfortunately employing such \GTO basis functions implies
that certain physical aspects like the exponential decay
are no longer directly built into the basis set.
More on that later.
Since $\varphi^\text{GTO}_\mu(\vec{r}) \in C^\infty(\R^3, \R)$,
which is a dense subset of $H^1(\R^3, \R)$
this is not \textit{per se} a problem:
The denseness assures that we can still represent every function
from $H^1(\R^3, \R)$ up to arbitrary accuracy
if enough {\GTO}s are used.
Furthermore this ensures that both the \HF problem as well as
the \FCI problem can still be solved
in a Ritz-Galerkin ansatz up to arbitrary accuracy if {\GTO}s are used.
But compared to the {\STO}s the {\GTO}s by themselves span a much smaller subset
of $H^1(\R^3, \R)$,
such that convergence is in general slower and more {\GTO}s are needed
to reach the same accuracy as a calculation employing {\STO}s.

As a remedy \citet{Hehre1969} introduced so-called
\newterm{contracted Gaussian-type orbitals}~(\cGTO),
where the radial part of a basis function $\varphi_\mu$
is expressed as a fixed linear combination of $N_\text{contr}$
\newterm{primitive Gaussians}%
\footnote{Here we follow the usual convention to include the normalisation constant
	inside the contraction coefficients}
\[ R^\text{cGTO}_\mu(r) = r^{l_\mu} \sum_i^{N_\text{contr}} c_{\mu,i} \exp(-\alpha_{\mu,i} r^2). \]
The idea is to get the best out of both worlds:
The easily solvable integrals in terms of primitive {\GTO}s
and the more accurate description of the wave function by using
special sets of \newterm{contraction coefficient}s
$c_{\mu,i}$ and exponents $\alpha_{\mu,i}$,
which are made to yield
a sensible basis set of {\cGTO}s $\{\varphi_\mu\}_{\mu\in\Ibas}$.
Essentially by the means of this trick
one splits the parameter space of the variational problem
\eqref{eqn:HFOptCoeff} or remark \ref{rem:FCI}
into two parts,
where one --- the contraction coefficients ---
is predetermined to fit a large range of problems
and one --- the expansion coefficients in the basis ---
is solved during the actual calculation with respect to a precise
chemical system.

Out of the pragmatic desire to perform molecular calculations
on systems larger than what was feasible with \STO basis sets at that time,
\citet{Hehre1969} initially focused on contracting primitive Gaussians
in a way that they most closely represented a minimal set of \STO functions.
This resulted in the famous STO-$n$G family of basis sets.
Later it was realised that more accurate basis sets could be constructed
by trying to minimise the energy,
which is resulted from an actual \HF or a MP2 calculation.
Other strategies include a rigorous construction
considering the convergence of obtained approximations
with respect to the amount of recovered correlation energy
in various types of methods.
Naturally this has lead to a number of different approaches
and thus to a number of different basis set families over the years.

Most of these share common concepts,
of which a few should be briefly sketched here.
For a more in-depth discussion of the construction of Gaussian basis sets
the reader is referred to the excellent reviews by \citet{Hill2013}
and \citet{Jensen2013}.
All basis sets, which are considered state-of-the-art nowadays,
are so-called \newterm{split-valence basis set}s,
which is meant to indicate that multiple contracted Gaussians are available
for describing the valence shell of an atom.
How many are used is typically referred to by the $\zeta$-level,
\eg a double-$\zeta$ basis set contains two \emph{contracted} Gaussians
for each valence orbital,
a triple-$\zeta$ basis set three and so on.
For this letters like \texttt{V}~(for split-valence)
and \texttt{D}, \texttt{T}, \texttt{Q}, \texttt{5}, \ldots
for double, triple, quadruple, quintuple level are usually found
in the name of the basis.
Notice, that each contracted Gaussian inside these basis sets
is typically in turn made up from multiple primitives.
For a particular basis set family the error generally decreases
going to higher zeta levels.
For some families like Dunning's correlation-consistent
basis sets~\cite{Dunning1989,Jensen2005}
empirical formulas for estimating the error at a particular basis set
level exist, see appendix \vref{apx:CbsLimit} for details.
To the best of my knowledge none of these results have been
backed up by rigorous analysis yet.
One should mention a recent work by \citet{Bachmayr2014} in this context,
where error estimates
in the relevant $H^1(\R^3,\R)$-norm
are derived
for Gaussian basis sets,
which only consists of primitive \GTO functions.
Such a result should be generalisable for {\cGTO} basis sets as well.

\begin{figure}
	\centering
	\includeimage{4_solving_hf/relative_error_cgto}
	\caption[Relative error in the hydrogen \HF ground state
		for a range of \cGTO basis sets]
	{Relative error in the hydrogen \HF ground state
		employing various \cGTO basis sets~%
		\cite{Hehre1969,Dunning1989,Jensen2001,Wilson1996}.
		The error is plotted against
		the relative distance of electron and proton.
	}
	\label{fig:RelativeErrorCgto}
\end{figure}
With the wide-spread \cGTO basis set families
a wide range of compromises between accuracy and computational costs is available.
Nevertheless some systematic issues related to the non-physical shape
of the primitive {\GTO}s can not be fully accounted for by forming contractions.
To illustrate this consider figure \ref{fig:RelativeErrorCgto},
where the
relative error of the hydrogen \HF ground state $\Phi_0$
with respect to the exact
electronic ground state $\Psi_{1s}$ \eqref{eqn:FunctionGShydrogen}%
\footnote{For hydrogen \HF is equivalent to solving the full Schr√∂dinger equation.}
\[ \frac{\Psi_0(\vec{r}) - \Psi_{1s}(\vec{r})}{\Psi_{1s}(\vec{r})}. \]
at various electron-proton distances is plotted.
We show this quantity for a range of standard \cGTO basis sets,
namely the minimal basis set STO-3G~\cite{Hehre1969},
the double-$\zeta$ basis sets cc-pVDZ~\cite{Dunning1989}
and pc-1~\cite{Jensen2001},
the quadruple-$\zeta$ basis set pc-3~\cite{Jensen2001}
as well as the sextuple-$\zeta$ basis set cc-pV6Z~\cite{Wilson1996}.
In each case the error is smallest at intermediate
electron-proton distances, but increases both at the origin
as well as at larger distance.
The former feature can be explained due to the faster fall-off
of the Gaussians $\exp(-\alpha r^2)$ compared to the exact solution,
which goes as $\exp(-\zeta r)$.
The latter feature originates from the failure of Gaussians
to represent the electron-nuclear cusp.
Larger basis sets like pc-3 or cc-pV6Z amount to recover the
correct decay behaviour and the cusp somewhat,
such that the error stays below $0.03 \equiv 3\%$
in the complete inner part of the plot up to distances
of about $7.5$ Bohr.
Eventually all relative errors tend towards $-\infty$ as $r \to \infty$,
however.
This includes the case of pc-3
where the curve has a local minimum around $r = 10$ and then follows a similar
trend as pc-1.
Overall the plots nevertheless agree with the rule of thumb
that errors become smaller and the trustworthy region larger
as we proceed from STO-3G to double zeta and further.

\begin{figure}[p]
	\centering
	\includeimage{4_solving_hf/local_energy_cgto}
	\caption[Local energy of the hydrogen \HF ground state]{
		Local energy $E_L(\vec{r})$ of the hydrogen atom \HF ground state
		obtained using the indicated contracted Gaussian basis sets%
		~\cite{Hehre1969,Dunning1989,Jensen2001,Wilson1996}.
		$E_L(\vec{r})$ is plotted against the relative distance
		of electron and nucleus.
	}
	\label{fig:LocalEnergyCgto}
\end{figure}

\begin{figure}[p]
	\centering
	\includeimage{4_solving_hf/local_energy_cgto_zoom}
	\caption[Local energy of the hydrogen \HF ground state (close-up)]{
		Zoom-in version of figure \vref{fig:LocalEnergyCgto}.
	}
	\label{fig:LocalEnergyCgtoZoom}
\end{figure}
In contrast to this figures
\ref{fig:LocalEnergyCgto} and \ref{fig:LocalEnergyCgtoZoom},
show the local energies \eqref{eqn:LocalEnergy}
of the aforementioned basis sets --- again as a function of relative distance.
These plots not only diverge to $-\infty$ at infinite distance,
but at the origin as well.
In the intermediate region all plots show fluctuations
around the exact energy value $0.5$ up to various extends,
as expected.
Since the local energy is related to the relative residual error,
the plots indicate,
that the \HF ground state obtained with \cGTO basis sets
describes the exact ground state reasonably well inside these intermediate regions,
but fails to do so both at large distances as well as the nucleus.
The size of the parts of the plot,
where $E_L(\vec{r})$ fluctuates little
agrees roughly with the parts where the relative error is small
in figure \ref{fig:RelativeErrorCgto}.

The most deviating behaviour of the local energy compared to the relative error
plots occurs in the region close to the nucleus,
see \ref{fig:LocalEnergyCgtoZoom}.
Especially for the larger basis sets pc-3 and cc-pV6Z
$E_L(\vec{r})$ starts to fluctuate rather vividly as $r \to 0$
and eventually diverges to $-\infty$.
So whilst these basis sets amount to produce a very good ground state
up to distances of roughly $7.5$ Bohrs anywhere else,
they show a wildly oscillating behaviour close to the core.
This can be explained following \cite{Ma2005}.
The potential term in the local energy \eqref{eqn:LocalEnergy} diverges
as $-Z_A/r$ close to the nucleus $A$,
such that the kinetic energy term needs to provide an equal and opposite
divergence in order for the resulting local energy to be constant.
Since the gradient of {\cGTO}s basis functions is zero at the origin,
so is the gradient of the final \HF ground state,
thus the local energy goes to $-\infty$.
Approaching the nucleus the behaviour is highly oscillatory
since the individual primitives have rather deviating gradient values
being a polynomial times Gaussian in the distance from the nucleus,
which sometimes leads to an overcompensation of the potential term
and sometimes an undercompensation in the second derivative
of the \HF ground state.

This feature is extremely problematic for quantum Monte-Carlo calculations%
~\cite{Foulkes2001,Ma2005},
where special measures need to be taken to account for these oscillations.
Even in standard \HF, \DFT and Post-\HF methods
the failure of the {\cGTO}s to represent the nuclear cusp
or the long-range behaviour needs to be considered
if either parts of the wave functions are especially important.
Certain properties of the electronic structure
like Rydberg-like excited states,
the computation of proper electron affinities
or nuclear-magnetic resonance properties,
requires specific basis sets~\cite{Hill2013,Jensen2013}.
If these are not used such features can be completely missed
or described very inaccurately.
In this sense {\cGTO}s are not black-box and
always require some sense of chemical intuition before a calculation is underdone
to get the right answer.
Conversely if one already has a clear idea about the electronic structure
of a chemical system it is usually possible to find a basis set,
which promises to represent the required features both efficiently
and accurately
amongst the off-the-shelf basis set families.

Due to the aforementioned Gaussian product theorem
the evaluation of the integrals involved
in building the Fock matrix $\mat{F}$ has been feasible for many years.
The resulting matrix is typically small.
Even for systems with 100s of atoms one typically only needs
in the order of 1000 basis functions.
Figure \vref{fig:StructureGaussianFock}
shows the Fock matrix from a \SCF calculation of a beryllium atom
in a pc-2~\cite{Jensen2007} basis set
at various points during a \SCF procedure.
The Pulay error Frobenius norm decreases from left to right
from $0.18$ to $0.0063$ and finally $4.1\E{-7}$.
The matrix is almost diagonal-dominant with 12 out of 15 rows $\mu$
satisfying the condition
\[
	\sum_{\nu=1}^{\Nbas} F_{\mu\nu} < 2 F_{\mu\mu}
\]
for \newterm{diagonal-dominance}.
Even for larger examples the structure of the matrix is similar
such that overall both standard dense eigensolver methods
like the ones implemented in the LAPACK library
or Davidson's method~(see section \vref{sec:Davidson} could be employed
and the matrix can be fully placed in memory,
which makes dealing with the eigenproblem very easy.

Overall it is no surprise that \cGTO-based methods
have become the standard approach in quantum-chemistry
as they promised a feasible route to a description of most chemical
systems within a decent accuracy.
They are the basis of a large range of quantum-chemistry program
packages%
\cite{Ahlrichs1989,ORCA,Hutter2014,Sun2017,Verstraelen2017}
\todoil{Cite Q-Chem, Molpro, Nwchem, Psi4, some more}\noindent
Nevertheless it is remarkable than only in \citeyear{Bachmayr2014}
\citet{Bachmayr2014} developed rigorous error bounds
and that choosing the right basis set seems often more like an art form
rather than a science,
where hardly ever checks with special basis sets are performed
if all the expected features of the electronic structure have
already been found.


\begin{landscape}
\begin{figure}[p]
	\centering
	\includeimage{4_solving_hf/fock_gaussian}
	\caption[Structure of the Fock matrix for a \cGTO-based \SCF]
		{Structure of the Fock matrix for a \cGTO-based \SCF
		for the beryllium atom
		using a pc-2~\cite{Jensen2007} basis set.
		The three figures show the SCF with a Pulay error
		Frobenius norm of $0.18$, $0.0063$ and $4.1 \cdot 10^{-7}$
		from left to right.}
	\label{fig:StructureGaussianFock}
\end{figure}

\begin{figure}[p]
	\centering
	\includeimage{4_solving_hf/fock_sturmian}
	\caption{Structure of the Fock matrix for a Coulomb-Strumian based SCF
		for the beryllium atom starting from using a $(5,1,1)$
		Coulomb-Strumian basis in $mln$ order
		and a Sturmian exponent of $\kexp = 1.99$.
		The three figures show left to right the Fock matrix
		at an SCF step with a Pulay error Frobenius norm of
		$0.13$, $0.0079$, $6.7 \cdot 10^{-8}$.}
		% 14 out of 17 are diagonal-dominant in each case.
		% Matrix is symmetric
	\label{fig:StructureSturmianFock}
\end{figure}
\end{landscape}
