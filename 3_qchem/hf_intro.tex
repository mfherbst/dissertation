\section{Single-determinant ansatz}
\label{sec:HFIntro}

\nomenclature{$\NelecA, \NelecB$}{Number of $\alpha$/$\beta$ electrons.
Note $\NelecA + \NelecB = \Nelec$ and $\NelecA \ge \NelecB$ by convention.}
\nomenclature{$\Iorb$}{Index set of computed SCF orbitals, typically $\{1, \ldots \Norb\}$}
\nomenclature{$\Norb$}{The number of computed SCF orbitals.
Note, that $\Norb \le \Nbas$.}

\defineabbr{HF}{HF\xspace}{Hartree-Fock}
%\nomenclature{$\Op{\rho}$}{Density operator}
\nomenclature{$\IoccA$, $\IoccB$}{Index set of occupied SCF orbitals of $\alpha$ or $\beta$ spin, respectively. Typically $\{1, \ldots, \NelecA\}$ and similar for $\IoccB$.}
\nomenclature{$\epsilonconv$}{Convergence tolerance for an iterative process.
	If the error is below this value, the process should be considered converged.}

\nomenclature{$\Op{K}$}{One-electron exchange operator}
\nomenclature{$\Op{J}$}{Effective Coulomb operator}

In the previous section we noted that even an approximate
solution to the electronic Schrödinger equation \eqref{eqn:ElectronicSchrödinger}
via the full CI ansatz
is hardly feasible.
Even if comparatively small one-electron basis sets
$\{ \varphi_\mu \}_{\mu\in\Ibas} \subset H^1(\R^3,\C)$
are used,
the dimensionality
of the matrix $\mat{A}_\text{FCI}$ becomes simply too large.
In this section we discuss the opposite end of the scale and
only consider one-dimensional subspaces of the form domain
\[ Q(\Op{H}_{\Nelec}) = \bigwedge_{i=1}^{\Nelec} H^1(\R^3, \C) \cap L^2(\R^3, \C) \]
for solving the electronic problem.
Formally by the Courant-Fischer theorem \eqref{thm:CourantFischer}
the ground state electronic energy $E_0$ can be obtained by
a variational minimisation over all subspaces of dimension $1$.
In other words
\begin{align}
	\label{eqn:GroundStateVariational}
	E_0 &= \inf_{\Psi \in \mathcal{W}_{\Nelec}} \braket{\Psi}{\Op{H}_{\Nelec} \Psi}_{\Nelec} \\
\intertext{where}
	\label{eqn:NormalisedFormDomain}
	\mathcal{W}_{\Nelec} &= \left\{ \Psi \in Q(\Op{H}_{\Nelec})
	\, \middle| \,
	\norm{\Psi}_{L^2(\R^{3 \Nelec}, \C)} = 1 \right\}.
\end{align}
denotes the subspace of all normalised functions from $Q(\Op{H}_{\Nelec})$.
If we restrict the search to only run over the space
\begin{equation}
	\mathcal{R}^1_{\Nelec} = \left\{ \bigwedge_{i=1}^{\Nelec} \psi_i
	\, \middle| \,
	\psi_i \in H^1(\R^3, \C),
	\braket{\psi_i}{\psi_j}_1 = \delta_{ij}
	\quad \forall \, 1\leq i,j\leq \Nelec
	\right\}
	\label{eqn:RankOneSubspace}
\end{equation}
of all normalised Slater determinants,
which is a proper subspace of $\mathcal{W}_{\Nelec}$,
we no longer yield the exact energy.
According to corollary \vref{cor:Convergence} we merely obtain an upper bound
\begin{equation}
	E_0 \leq E_0^\text{HF} = \inf_{\Phi \in \mathcal{R}^1_{\Nelec}}
	\braket{\Phi}{\Op{H}_{\Nelec} \Phi}_{\Nelec}.
	\label{eqn:HFDeterminant}
\end{equation}
The implied procedure,
where an approximation to the electronic ground state
is computed by minimising the sesquilinear form of $\Op{H}_{\Nelec}$
over the space spanned by all normalised Slater determinants,
is the celebrated \newterm{Hartree-Fock}~(\HF) approximation~\cite{Fock1930}.
The resulting minimal energy $E_0^\text{HF}$
is the \HF ground state energy
and the corresponding minimising determinant
$\Phi_0$ the \HF ground state.

The \HF approach is named both
after Douglas Hartree and Vladimir Fock.
Historically \citet{Hartree1928} first proposed
an ansatz for the electronic problem
based on symmetric products of one-electron functions,
which is algorithmically very similar to the procedure followed
nowadays~(see remark~\vref{rem:SCF}).
\citet{Slater1939a}
and \citet{Fock1930} then both noted
the issue arising from the use of symmetric
products in the context of spin~(see section \vref{sec:ElectronicSchrödinger})
and subsequently Fock reformulated the procedure
using Slater determinants.

Notice, that $\Phi_0$ is --- by construction ---
the best possible single Slater determinant to
approximate the electronic ground state.
Mathematically speaking the set of Slater determinants
$\mathcal{R}^1_{\Nelec}$
is exactly the set of all elements from $\mathcal{W}_{\Nelec}$,
which are of tensor rank 1.
For this reason one sometimes refers to the Hartree-Fock
ground state $\Phi_0$
as a \textbf{rank-1 approximation} to the exact
electronic ground state.

\begin{rem}[Molecular orbital formulation of \HF]
	Let
	\[  \Theta \equiv \left(\psi_1, \psi_2, \ldots, \psi_{\Nelec}\right)
		\in \left(H^1(\R^3, \C)\right)^{\Nelec} \]
	denote an arbitrary tuple of single-particle functions.
	It uniquely defines a Slater determinant
	$\Phi_\Theta = \bigwedge_{i=1}^{\Nelec} \psi_i.$
	Inserting this ansatz into the energy expression
	\eqref{eqn:EnergySlaterDeterminant} for a single determinant
	yields the \newterm{Hartree-Fock energy functional}
	\begin{equation}
		\begin{aligned}
		\mathcal{E}^\text{HF}(\Theta)
		&= \frac12 \sum_{i=1}^{\Nelec} \int_{\R^3} \norm{\nabla \psi_i}_2^2 \D\vec{r}
		+ \int_{\R^3} \sum_{A=1}^M
			\frac{\rho_\Theta(Z_A \, \vec{r})}{\norm{\vec{r} - \vec{R}_A}_2} \D\vec{r} \\
		&\hspace{20pt}
		+ \frac12 \int_{\R^3}\int_{\R^3}
			\frac{\rho_\Theta(\vec{r}_1) \rho_\Theta(\vec{r}_2)}
				{\norm{\vec{r}_1 - \vec{r}_2}_2} \D\vec{r}_1 \D\vec{r}_2
		- \frac12 \int_{\R^3}\int_{\R^3}
			\frac{\abs{\gamma_\Theta(\vec{r}_1, \vec{r}_2)}^2}
				{\norm{\vec{r}_1 - \vec{r}_2}_2} \D\vec{r}_1 \D\vec{r}_2
		\end{aligned}
		\label{eqn:HFEnergyFunctional}
	\end{equation}
	where
	\begin{align}
		\label{eqn:HFDensityNoSpin}
		\rho_\Theta(\vec{r}) &= \sum_{i=1}^{\Nelec} \abs{\psi_i(\vec{r})}^2
		&\text{and} &&
		\gamma_\Theta(\vec{r}_1,\vec{r}_2)
			&= \sum_{i=1}^{\Nelec} \cc{\psi}_i(\vec{r}_1) \psi_i(\vec{r}_2)
	\end{align}
	are the \newterm{electron density}
	and the \newterm{one-particle reduced density matrix}, respectively.
	The HF ansatz \eqref{eqn:RankOneSubspace}
	thus becomes
	\begin{equation}
		E_0 \leq E_0^\text{HF}
		= \inf \left\{
			\mathcal{E}^\text{HF}(\Theta)
			\, \middle| \,
			\Theta \in \left(H^1(\R^3, \C)\right)^{\Nelec}, \,
			\forall i,j \,
			\braket{\psi_i}{\psi_j}_1 = \delta_{ij}.
		\right\}
		\label{eqn:HFMO}
	\end{equation}
	The minimiser $\Theta^0$, \ie the tuple for which the minimum
	energy $E_0^\text{HF} = \mathcal{E}^\text{HF}(\Theta^0)$
	is exactly obtained,
	defines the HF ground state
	$\Phi_0 \equiv \Phi_{\Theta^0}$.
\end{rem}

Before we discuss the mathematical properties of the \HF ansatz,
let us first pick up on our discussion
of spin in section \vref{sec:ElectronicSchrödinger}
and generalise our formalism slightly.

\begin{rem}[Spin-adapted formulation of \HF]
	\label{rem:Spin}
	The mathematical treatment up to this point
	only includes one property resulting from the spin-$\sfrac12$ nature
	of electrons,
	namely the antisymmetry of the wave function.
	The missing property is the explicit inclusion of the spin degree of freedom.
	For a single spin-$\sfrac12$ particle the spin degree of freedom
	by itself spans the two-dimensional Hilbert space $\C^2$,
	which can be probed by the one-particle spin operator
	\[ \op{\vec{s}} \equiv \left( \op{s}_x, \op{s}_y, \op{s}_z \right)
		= \frac12 \left( \sigma_x, \sigma_y, \sigma_z \right). \]
	In this expression we used the \newterm{Pauli matrices} defined as
	\begin{align}
		\label{eqn:PauliMatrices}
		\sigma_x &= \mm{0&1\\1&0} &
		\sigma_y &= \mm{0&-\I\\\I&0} &
		\sigma_z &= \mm{1&0\\0&-1}.
	\end{align}
	The operator $\op{s}_z$ has two eigenstates
	\begin{align*}
		\uparrow &\equiv \mm{1\\0} & \downarrow &\equiv \mm{0\\1}
	\end{align*}
	which are called \newterm{spin-up} and \newterm{spin-down}, respectively.

	One way to incorporate this into our present formalism
	is the \newterm{spinor} formalism,
	where a one-particle function is now written as a \newterm{two-component} function
	\begin{equation}
		\psi(\vec{r}) \equiv \mm{\psi^\alpha(\vec{r}) \\ \psi^\beta(\vec{r})}
		\label{eqn:OneParticleSpinor}
	\end{equation}
	mapping each real coordinate $\vec{r}$ to a complex spinor from $\C^2$.
	All results from functional analysis and spectral theory
	which we derived for the spin-free case can be adapted to the
	spinor formalism,
	simply moving from the function space $L^2(\R^3, \C)$
	(and its subspaces) to $L^2(\R^3, \C^2)$.
	For example for two spin-adapted one-particle functions
	\begin{align*}
		\psi &\equiv \smallmm{\psi^\alpha\\ \psi^\beta} \in L^2(\R^3, \C^2)
		&&\text{and} &
		\varphi &\equiv \smallmm{\varphi^\alpha\\ \varphi^\beta} \in L^2(\R^3, \C^2)
	\end{align*}
	the one-particle inner product $\braket{\slot}{\slot}$ becomes
	the $L^2(\R^3, \C^2)$ inner product
	\[ \braket{\psi}{\varphi}_1 \equiv
		\int_{\R^3} \braket{\psi(\vec{r})}{\varphi(\vec{r})}_{2} \D \vec{r}
		= \int_{\R^3}
			\cc{\left(\psi^\alpha\right)}\!\!(\vec{r}) \  \varphi^\alpha(\vec{r})
			+
			\cc{\left(\psi^\beta\right)}\!\!(\vec{r})\  \varphi^\beta(\vec{r})
		\D \vec{r}
	\]
	in analogy to the spin-free case.
	In a similar fashion one may construct the exterior power
	$\bigwedge_{i=1}^{\Nelec} L^2(\R^3, \C^2)$
	and Slater determinants $\bigwedge_{i=1}^{\Nelec} \psi_i$
	from functions $\psi_i \in H^1(\R^3, \C)$.
	Notice that the tensor product nature of the exterior power
	implies
	\[ \bigwedge_{i=1}^{\Nelec} L^2(\R^3, \C^2) \subset L^2(\R^{3\Nelec}, \C^{2\Nelec}) \]
	and
	\begin{equation}
		\bigwedge_{i=1}^{\Nelec} \psi_i \in \bigwedge_{i=1}^{\Nelec} H^1(\R^3, \C^2)
		\subset H^1(\R^{3\Nelec}, \C^{2\Nelec}).
		\label{eqn:SpinAnsatzSpace}
	\end{equation}
	In this sense most of the derivations from this chapter can be brought forward
	to the spin-adapted case as well.
	For example the expression of the \HF energy functional
	$\mathcal{E}^\text{HF}(\Theta)$ can be used exactly as stated in
	\eqref{eqn:HFEnergyFunctional}
	for a tuple
	\[ \Theta \equiv \left(\psi_1, \psi_2, \ldots, \psi_{\Nelec}\right)
		\in \left(H^1(\R^3, \C^2)\right)^{\Nelec} \]
	of spin-adapted one-particle functions as well,
	provided that we understand the gradient
	\[ \nabla \psi_1 \equiv \mm{ \nabla \psi_1^\alpha \\ \nabla \psi_1^\beta } \in \C^6 \]
	as a vector from $\C^6$
	and define the density as
	\begin{align}
		\rho_\Theta(\vec{r}) &= \sum_{i=1}^{\Nelec} \norm{\psi_i(\vec{r})}_2^2
		= \sum_{i=1}^{\Nelec} \abs{\psi_i^\alpha(\vec{r})}^2 + \abs{\psi_i^\beta(\vec{r})}^2 \\
	\intertext{and the one-particle density matrix as}
		\gamma_\Theta(\vec{r}_1,\vec{r}_2)
		&= \sum_{i=1}^{\Nelec} \braket{\psi_i(\vec{r}_1)}{\psi_i(\vec{r}_2)}_2
		= \sum_{i=1}^{\Nelec} \cc{\left(\psi_i^\alpha\right)}\!\!(\vec{r}_1)\  \psi_i^\alpha(\vec{r}_2)
			+ \cc{\left(\psi_i^\beta\right)}\!\!(\vec{r}_1)\  \psi_i^\beta(\vec{r}_2).
	\end{align}

	The extra spin component introduces another complication
	into the \HF procedure.
	Analogously to the one-particle spin operator $\op{\vec{s}}$
	and component operators $\op{s}_x, \op{s}_y, \op{s}_z$
	for a single particle,
	one can define the total spin operator $\Op{\vec{S}}$
	as well as $\Op{S}_x, \Op{S}_y, \Op{S}_z$,
	which yield the equivalent quantities for an $\Nelec$-electron system.
	Originating from $\Op{\vec{S}}$ one may define
	\[ \Op{S}^2 = \Op{\vec{S}} \cdot \Op{\vec{S}} = \left(\Op{S}^2_x, \Op{S}^2_y, \Op{S}^2_z\right). \]
	One can show~\cite{Shankar1994} that
	\[ \comm{\Op{S}^2}{\Op{S}_z} = 0, \]
	\ie that the total spin squared operator commutes with $\op{s}_z$.
	Furthermore since the Hamiltonian $\Op{H}_{\Nelec}$ makes no explicit reference
	to any particular spin component,
	we necessarily have
	\begin{equation}
		\comm{\Op{S}_z}{\Op{H}_{\Nelec}} = \comm{\Op{S}^2}{\Op{H}_{\Nelec}} = 0.
		\label{eqn:CommutationSpinHamlitonian}
	\end{equation}
	This implies\footnote{%
		Since $\Op{A}\Op{B} f = \Op{B}\Op{A} f \Leftrightarrow \comm{A}{B} = 0$.%
	}
	that one is able to find simultaneous eigenfunctions of $\Op{H}_{\Nelec}$,
	$\Op{S}_z$ and $\Op{S}^2$.
	For many applications of electronic structure theory,
	\eg the interpretation of certain spectroscopic results
	or for understanding the aforementioned Stern-Gerlach experiment,
	the determination of simultaneous eigenstates of these three operators at once
	is crucial.
	Due to \eqref{eqn:CommutationSpinHamlitonian}
	this must be possible for the exact ground state of $\Op{H}_{\Nelec}$ as well.
	There is, however, no guarantee that the \HF ansatz
	\eqref{eqn:HFMO} gives rise to a ground state $\Phi_{\Theta^0}$,
	which is an eigenfunction of $\Op{S}_z$ or $\Op{S}^2$~\cite{Fukutome1981,McWeeny1985}.
	In fact it is rather easy to construct Slater determinants,
	which are neither an eigenstate of $\Op{S}_z$ nor of $\Op{S}^2$.
	\todoil{Give an example}

	There are two common approaches to deal with this issue~\cite{McWeeny1985}.
	One is to minimise according to \eqref{eqn:HFMO}
	and then use appropriate projections in order to yield the required
	eigenstates with respect to $\Op{S}_z$ and $\Op{S}^2$.
	We will not consider this approach in this work any further.
	The other ansatz is to impose conditions
	on the ansatz space \eqref{eqn:SpinAnsatzSpace},
	such that the resulting \HF ground states
	are eigenfunctions of $\Op{S}_z$ and $\Op{S}^2$.
	This is what we will discuss when we move to a discretised
	treatment of the \HF ansatz in \vref{rem:HFDiscrete}.
\end{rem}

Even though the Hartree-Fock ansatz was already proposed
by \citet{Fock1930} in \citeyear{Fock1930},
its fundamental mathematical properties were
only rigorously characterised and proved by Lieb~\cite{Lieb1977}
and Lions~\cite{Lions1987,Lions1989} in the 70s and 80s
for the general spin-adapted case.
The are summarised in the following.

\begin{rem}[Invariance under orbital rotations]
	\label{rem:HFInvariance}
	Let
	\[ \Theta = \left(\psi_1, \psi_2, \ldots, \psi_{\Nelec}\right)
		\in \left(H^1(\R^3, \C^2)\right)^{\Nelec} \]
	be a tuple, which satisfies the orthonormality condition
	\begin{equation}
		\forall i,j \in 1,\ldots,\Nelec: \quad \braket{\psi_i}{\psi_j}_1 = \delta_{ij}.
		\label{eqn:OrthonormalityCodition}
	\end{equation}
	One can easily show~\cite{Lions1989},
	that for any unitary matrix $\mat{U} \in \C^{\Nelec\times\Nelec}$ it holds:
	\begin{itemize}
		\item $\Theta' = \Theta \mat{U}$ satisfies \label{eqn:OrthonormalityCodition} as well.
		\item $\mathcal{E}^\text{HF}(\Theta \mat{U}) = \mathcal{E}(\mat{U})$
	\end{itemize}
	In other words all properties of \HF can only be stated up to
	a unitary rotation amongst the constituents of the ground state Slater
	determinant $\Phi_0$.
\end{rem}

\begin{thm}[Mathematical properties of \HF]
	\label{thm:MathematicalHF}
	Assume $\Nelec \leq \sum_{A=1}^M Z_A$, \ie a neutral or positively charged chemical system.
	\begin{enumerate}
		\item A minimiser
			\begin{equation}
				\Theta^0 = \left(\psi_1^0, \psi_2^0, \ldots, \psi_{\Nelec}^0 \right)
					\in \left( H^1(\R^3, \C^2) \right)^{\Nelec}
				\label{eqn:HFTheoremMinimiser}
			\end{equation}
			to $\mathcal{E}^\text{HF}$ exists~\cite{Lieb1977},
			\ie the \HF model \eqref{eqn:HFMO} has a ground state.
		\item Let us define the \newterm{Fock operator}
			\begin{equation}
				\Op{F}_{\Theta^0} = \Op{T} + \Op{V}_0 + \Op{J}_{\Theta^0} + \Op{K}_{\Theta^0}
				\label{eqn:FockOperator}
			\end{equation}
			consisting of the kinetic energy operator $\Op{T}$ and
			the nuclear attraction operator $\Op{V}_0$ as defined in \eqref{eqn:HCore}
			as well as the effective \newterm{Coulomb operator}
			\begin{align}
				\label{eqn:OperatorCoulomb}
					\Op{J}_{\Theta^0} &= \int_{\R^3} \frac{\rho_{\Theta^0}(\vec{r}_2)}
						{\norm{\slot - \vec{r}_2}_2} \D \vec{r}_2 \\
				\intertext{and the \newterm{exchange operator}, implicitly defined by}
					\left( \Op{K}_{\Theta^0} \chi \right)(\vec{r})
					&= - \int_{\R^3} \frac{\gamma_{\Theta^0}(\vec{r}, \vec{r}_2)}
						{\norm{\vec{r} - \vec{r}_2}_2} \chi(\vec{r}_2) \D \vec{r}_2.
				\label{eqn:OperatorExchange}
			\end{align}

			To find the minimiser of $\mathcal{E}^\text{HF}$ one needs
			to solve the Euler-Lagrange equations corresponding to the minimisation
			problem \eqref{eqn:HFMO}.
			They state, that $\Theta^0$ as defined in \eqref{eqn:HFTheoremMinimiser}
			is a minimiser to $\mathcal{E}^\text{HF}$ if and only if
			there exists a Hermitian matrix $\mat{\lambda} \in \C^{\Nelec\times\Nelec}$
			such that for all $i,j \in \{1,\ldots,\Nelec\}$
			\begin{align}
				\label{eqn:EulerLagrangeHF}
				\Op{F}_{\Theta^0} \psi_i^0 &= \sum_{ij} \lambda_{ij} \psi_j^0
				&&\text{and}&
				\braket{\psi_i^0}{\psi_j^0} &= \delta_{ij}
			\end{align}
			hold.

			Once we found the ground state, the application of the Fock operator
			will thus only rotate us around the space spanned by the minimising
			functions from $\Theta^0$.
		\item Due to the elliptic regularity theorem~\cite{Lieb1977}
			\[ \psi_i^0 \in H^2(\R^3,\C^2) \cap C^\infty(\R^3 \backslash \{\vec{R}_A\}_{A=1,\ldots,M},\C^2), \]
			which implies that a solution to \eqref{eqn:EulerLagrangeHF}
			will always be sooth everywhere but the nuclei and globally in $H^2(\R^3,\C^2)$.
		\item The Fock operator $\Op{F}_{\Theta^0}$ as defined in \eqref{eqn:FockOperator}
			is a self-adjoint operator on $L^2(\R^3,\C^2)$
			with domain $D(\Op{F}_{\Theta^0}) = H^2(\R^3,\C^2)$
			and form domain $Q(\Op{F}_{\Theta^0}) = H^1(\R^3,\C^2)$~\cite{Lions1987}.
			It is bounded below and $\sigma_\text{ess} =[0, +\infty)$.
		\item Up to replacing $\Theta^0$ by $\Theta^0 \mat{U}$
			for some unitary matrix $\mat{U} \in \C^{\Nelec\times\Nelec}$,
			the canonical \newterm{Hartree-Fock equations} hold
			\begin{align}
				\label{eqn:HFequations}
				\Op{F}_{\Theta^0} \psi_i^0 = \varepsilon_i \psi_i^0
				&&\text{and}&
				\braket{\psi_i^0}{\psi_j^0} &= \delta_{ij}
			\end{align}
			with
			\[ \varepsilon_1 \leq \varepsilon_2 \leq \cdots \leq \varepsilon_{\Nelec} < 0. \]
		\item The \newterm{Aufbau principle} is satisfied:
			The $\{\varepsilon_1, \ldots,\varepsilon_{\Nelec} \}$
			are the lowest $\Nelec$ eigenvalues of $\Op{F}_{\Theta^0}$.
		\item Let $\varepsilon_{\Nelec+1}$ be the $(\Nelec+1)$-th eigenvalue of $\Op{F}_{\Theta^0}$
			if the Fock matrix has $(\Nelec+1)$ negative eigenvalue (counting multiplicities)
			otherwise set $\varepsilon_{\Nelec+1} = 0$.
			The \textbf{no unfilled-shell} property
			\[ \varepsilon_{\Nelec} < \varepsilon_{\Nelec+1} \]
			is satisfied~\todo{cite Bach, Lieb, Loss, Solovej 1994}.
	\end{enumerate}
\end{thm}
The proofs for these results in the general setting are somewhat involved
and can be found in the cited works.
To sketch the required steps appendix \vref{apx:HFTheoremFinite}
proves some of the results of remark \ref{rem:HFInvariance}
and theorem \ref{thm:MathematicalHF} in a finite-dimensional setting.

We will return to some of the results of theorem \ref{thm:MathematicalHF}
further down this section.
Let us just note, that theorem \ref{thm:MathematicalHF} allows to recast
the \HF ansatz \eqref{eqn:HFMO} into an equivalent spectral problem \eqref{eqn:HFequations}
for the Fock operator.
This problem satisfies all the spectral requirements for applying the Ritz-Galerkin ansatz
of remark \vref{rem:DiscreteFormulation},
such that a Ritz-Galerkin ansatz can be applied.

\defineabbr{UHF}{UHF\xspace}{unrestricted Hartree-Fock}
\defineabbr{GUHF}{GUHF\xspace}{generalised unrestricted Hartree-Fock}
\defineabbr{RHF}{RHF\xspace}{restricted Hartree-Fock}
\defineabbr{ROHF}{ROHF\xspace}{restricted open-shell Hartree-Fock}
\begin{rem}[Discretised \HF equations]
	\label{rem:HFDiscrete}
	Assume a one-particle basis $\{\varphi_\mu\}_{\mu\in\Ibas}$
	consting of $\Nbas = \abs{\Ibas}$
	basis functions taken from a dense subspace of $H^1(\R^3,\C)$.
	The space
	\[
		\mathcal{S}_1 = \spacespan \left\{
			\mm{\varphi_\mu \\ 0 }, \mm{0\\\varphi_\mu}
		\, \middle| \, \mu \in \Ibas \right\}
	\]
	spanned by spin-adapted linear combinations from
	$\{\varphi_\mu\}_{\mu\in\Ibas}$
	is a subspace of $H^1(\R^3,\C^2)$.
	Consequently
	\[ \left\{ \bigwedge_{i=1}^{\Nelec} \psi_i \,\middle|\, \psi_i \in \mathcal{S}_1,
	\braket{\psi_i}{\psi_j}_1 = \delta_{ij} \right\} \subset \mathcal{R}^1_{\Nelec}, \]
	which implies
	\[
		E_0 \leq E_0^\text{HF} \leq \tilde{E}_0^\text{HF} = \inf \left\{
		\mathcal{E}^\text{HF}(\Theta)
		\, \middle| \,
		\Theta = \left(\psi_1, \ldots, \psi_{\Nelec}\right) \in (\mathcal{S}_1)^{\Nelec},
			\braket{\psi_i}{\psi_j}_1 = \delta_{ij}
		\right\}.
	\]
	Let us denote with
	\[ \bm{\varphi} = \mm{\varphi_1 & \varphi_2 & \cdots & \varphi_{\Nbas}} \]
	the row vector of all basis functions written one after another.
	Then each element $\psi_i$ of the tuple
	\begin{equation}
		\Theta = \left(\psi_1, \ldots, \psi_{\Nelec}\right) \in (\mathcal{S}_1)^{\Nelec}
		\label{eqn:HFTuple}
	\end{equation}
	can be expanded as
	\begin{equation}
		\psi_i = \mm{\psi_i^\alpha\\\psi_i^\beta}
		= \sum_{\mu\in\Ibas} \varphi_\mu \, \mm{
			\tilde{C}^\alpha_{\mu i} \\
			\tilde{C}^\beta_{\mu i}
		}
		= \underbrace{\mm{\bm{\varphi} & 0 \\ 0 & \bm{\varphi}}}_{
			\substack{\text{$2$ rows,} \\ \text{$2\Nbas$ columns}}}
			\mm{%
				\tilde{C}^\alpha_{1i} \\ \vdots \\ \tilde{C}^\alpha_{\Nbas i} \\[5pt]
				\tilde{C}^\beta_{1i} \\ \vdots \\ \tilde{C}^\beta_{\Nbas i}
			}.
		\label{eqn:HFDiscretisationAnsatzPhi}
	\end{equation}
	This allows to write
	\begin{align}
		\Theta &= \mm{\bm{\varphi} & 0 \\ 0 & \bm{\varphi}} \mat{C}
		&&\text{where}&
		\mat{C} &= \mm{\tilde{\mat{C}}^\alpha \\ \tilde{\mat{C}}^\beta}
			\in \C^{2 \Nbas \times \Nelec}.
		\label{eqn:HFDiscretisationAnsatz}
	\end{align}
	$\mat{C}$ is the \newterm{coefficient matrix}, which is built by pastingi
	the row matrices at the right hand side of \eqref{eqn:HFDiscretisationAnsatz}
	one after another.

	It is not hard to imagine
	that one could insert \eqn{eqn:HFDiscretisationAnsatz}
	into the expression for the \HF energy functional $\Ehf$
	in order to obtain an expression of the \HF energy
	in terms of $\mat{C}$.
	This expression could be minimised
	with respect to the coefficients $\mat{C}$
	in order to obtain an approximate
	\HF ground state energy and a corresponding approximate \HF ground state.
	As it turns out~\cite{McWeeny1985}
	this so-called \newterm{generalised unrestricted Hartree-Fock}~(\GUHF)
	suffers exactly from the issues raised at the end of remark \vref{rem:Spin},
	namely that the resulting \HF ground state
	is neither an eigenfunction of $\Op{S}^2$ nor $\Op{S}_z$.
	So it is hardy ever performed in practice.

	Instead one typically selects an eigenvalue $M_S$
	of $\Op{S}_z$ before performing the \HF procedure
	using chemical intution and determines two parameters
	$\NelecA$ and $\NelecB$,
	the number of spin-up and the number of spin-down electrons,
	such that
	\begin{align*}
		\NelecA + \NelecB &= \Nelec & M_S = \frac12 \left( \NelecA - \NelecB\right).
	\end{align*}
	One can show~\cite{Szabo1996,Helgaker2013},
	that any Slater determinant $\Phi_\Theta$
	made from a tuple like \eqref{eqn:HFTuple}
	is exaclty an eigenfunction of $\Op{S}_z$ with eigenvalue $M_S$
	if it consists of $\NelecA$ single-particle functions with zero $\beta$
	component and $\NelecB$ single-particle functions with zero $\alpha$ component.
	Invoking remark \vref{rem:HFInvariance}
	we can always reorder the single-particle functions
	such that the $\NelecA$ functions with zero $\beta$ components are first.
	Thus this leads to the conditions
	\begin{align*}
		\psi_i^\beta  &= 0 \ \forall i \in \{1,\ldots,\NelecA\}
		&&\text{and}&
		\psi_i^\alpha  &= 0 \ \forall i \in \{\NelecA+1,\ldots,\Nelec\}.
	\end{align*}
	Applying these conditions
	to the generalised unrestricted Hartree-Fock ansatz \eqref{eqn:HFDiscretisationAnsatz}
	leads to the \newterm{unrestricted Hartree-Fock}~(\UHF) method%
	\footnote{
		This naming is unfortunate, since the \UHF certainly does imply a restriction
		of the search space due to spin symmetry,
		but happend for historic reasons
	}~\cite{Pople1954}.
	In \UHF the coefficient matrix $\mat{C}$ of \eqref{eqn:HFDiscretisationAnsatz}
	becomes block-diagonal
	\begin{equation}
		\label{eqn:HFCoeffMatrix}
		\mat{C}^\text{occ} = \mm{\mat{C}^\alpha & 0 \\ 0 & \mat{C}^\beta}
			\in \C^{\Nelec \times 2\Nbas},
	\end{equation}
	where $\mat{C}^\alpha \in \C^{\Nbas \times \NelecA}$
	and $\mat{C}^\beta \in \C^{\Nbas \times \NelecB}$
	are the spin-up and spin-down coefficient matrices, respectively.
	Inserting \eqref{eqn:HFDiscretisationAnsatz} and \eqref{eqn:HFCoeffMatrix}
	into \eqref{eqn:HFEnergyFunctional}
	we obtain the \HF energy functional in terms of
	of the coefficient matrix $\mat{C}$.
	\begin{equation}
		\Ehf(\mat{C}\cc{\mat{C}})
			= \tr \left( \tp{\mat{C}} \left(\mat{T} + \mat{V}_0 \right) \mat{C} \right)
			+ \tr \left( \tp{\mat{C}} \left(\matJfull + \matKfull \right) \mat{C} \right)
		\label{eqn:HFEnergyFunctionalCoeff}
	\end{equation}
	which can also be expressed as
	\begin{equation}
		\Ehf(\mat{D})
			= \tr \left( \mat{D} \left(\mat{T} + \mat{V}_0 \right) \mat{D} \right)
			+ \tr \left( \left(\matJfull + \matKfull \right) \mat{D} \right)
		\label{eqn:HFEnergyFunctionalCoeff}
	\end{equation}

	% explain other matrices
	% structure: which are block-diagonal

	which can be written in terms of the density matrix as well


	The corresponding fock matrix?




	Density matrices
	\begin{align*}
		\mat{D}^\alpha &= \left(\mat{C}^\alpha\right)^\dagger &
		\mat{D}^\beta  &= \left(\mat{C}^\alpha\right)^\dagger &
		%
		\mat{D} &= \mat{C}^\dagger \mat{C} & \mat{D}^\dagger \left(\mat{C}^\alpha\right)^\dagger + 
	\end{align*}<++>
	

	

	% F block diagonal
	% D block diagonal

	discretised fock $\matF$
	including dependency on $\mat{C}$: $\matFfull$

	% Integrals to be computed by basis library

	% Maybe not use this wording in the non-discretised case,
	% but do use \mat{F}\left[ \mat{C} \right] in the discretised

	% terms to mention:
	$\Iorb, \Norb, \IoccA, \IoccB, \epsilonconv$

	% Iorb -> numerically one often computes more orbitals than what is needed
	% to obtain the \psi, hence \IoccA and \IoccB


	\begin{itemize}
	\item
	$\psi$ HF orbitals or (SCF) orbital basis,
	typically in FCI one uses the HF orbital basis as the one-particle basis functions for FCI
		\end{itemize}
\end{rem}

\begin{rem}[Properties of the discretised HF ansatz]
% define occupied and virtual
With the elliptic regularity at hand we can even expect convergence of such a discretised
scheme to be fast
at all places except the nuclei,
since the solution is infinitely differentiable almost everywhere.


fast, since the functions are smooth everywhere 




% mention term SCF

equivalent problem of diagonalisation
to find MOs from AOs
allows to define concept of occupied and virtual orbitals
No unfilled shell means Homo lumo gap
\end{rem}


\begin{rem}[Sketch of the SCF procedure]
	\label{rem:SCF}
	tada
	% emphasize how spin is treated
\end{rem}

\subsection{Types of Hartree-Fock}
% UHF ground state (derived here) no eigenfunction of S^2
This is unrestricted HF
there are also restricted versions
-> brief only mention differences. The peculiar details
should follow in the next chapter

\todoil{
	Quick note that real is possible: \\
For an atomic system, we can consider the nucleus to be located at the origin
of the coordinate system, which allows us to simplify
the Hamiltonian to \\
Argue that we can do the mathematical background in real function
arithmetic only and still use the results for complex input due to linearity.
$\Psi \in H^2(\R^{3d}, \R)$
}

% --------------------------------




\newterm{Hartree-Fock}
\todo[inline,caption={}]{
	\begin{itemize}
		\item Summary of the numerical task
		\item Summary of the result (SCF orbitals)
		\item Explain properties of the individual terms of Fock operator (locality, ..)
	\end{itemize}
}



%TODO
% Explain the term Hartree-Fock and SCF (idea from Hartree, but spin adaption from Fock and Slater)
