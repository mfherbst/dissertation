\chapter{Preface}
\chapquote{%
Humanity needs practical men,
who get the most out of their work, and,
without forgetting the general good,
safeguard their own interests.
But humanity also needs dreamers,
for whom the disinterested development of an enterprise is
so captivating that it becomes impossible for them to devote
their care to their own material profit.}
{Marie Sk≈Çodowska Curie~(1867--1934)}

\todo[inline,caption={}]{
	\begin{itemize}
		\item  Why electronic structure theory at all?
		\item Historic context, vision
		\item Beauty of maths in science
		\item What this thesis is about
		\item Structure of the thesis
		\item Mention the relationship to other scientists
			and this thesis is just a small building block
		\item mention where the topic and idea for the thesis came from
		\item Overall we care about single-molecule or single-atom setting.
		\item More precisely this thesis only deals with
			treatment in vacuum and computation of the ground state
			and a few excited states
		\item Sketch the scope of this thesis (atoms and molecules, no extended systems)
	\end{itemize}
}

Even though computational electronic structure theory
has been a very active field of research since the 1930s
the fundamental question, which type of functions
are best used for a numerical treatment of the
electronic wave function, has still not yet been answered conclusively.
Most available program packages for performing
quantum-chemical calculations nevertheless focus
solely on methodologies based on
the linear combination of Gaussian-shaped atomic orbital functions.
One may rationalise this predominance
by the pragmatic historic developments
taking place in the founding years of modern electronic structure theory%
~\cite{Boys1950, Hehre1969}.
Most notably it was realised that the electron-repulsion integrals
of Gaussian-type orbitals~(GTOs) are computationally
much more feasible than the physically more exact
exponential-shaped Slater-type orbitals~(STOs)~\cite{Slater1930}.
This set off many developments
both in terms of efficient algorithms as well as methodologies
centered around GTOs,
making approaches based on GTOs widely applicable
for simulating electronic structures.

Nevertheless it is a well-known fact
that even contracted GTOs are not able to represent
all features of the electron density well.
Most prominently they fail to describe the nuclear cusp as well as
the exponential decay of the electron density~\cite{Kato1957}.
Whilst in most practical use cases one is able to compensate
by employing specialised Gaussian basis sets~\cite{Jensen2013,Hill2013},
there are strong hints that the accurate computation of properties
like NMR shielding tensors~\cite{Guell2008,Hoggan2009}
requires a correct description of the core-like region or the tail, too.
\todoil{James: Will you put in more references to PF Loos
and the guys doing the ionising Sturmian properties here.}

% --
The downside of GTOs is of course that they do not describe the physical
reality that well and as a result fail to capture all of the properties
of an electronic structure in a truely black-box fashion.
For example the computation of proper electron affinities or the description
of Rydberg-like excited states requires incorporating diffuse functions
with small Gaussian exponents into the GTO basis set.
% --

It should not come as a surprise that numerous research groups
have looked into alternative basis function types.
Next to plane-waves or projector-augmented wave methods%
~\cite{Kresse1996,Kresse1999,Mortensen2005,Enkovaara2010}
so-called numerical basis functions~\cite{Frediani2015}
have become popular in the recent years as well.
Examples for such efforts would be the use of wavelets%
~\cite{Bischoff2011,Bischoff2012,Bischoff2013,Bischoff2014,Bischoff2014a,Bischoff2017}
or finite elements%
~\cite{Tsuchida1995,Soler2002,Lehtovaara2009,Alizadegan2010,Avery2011PhD,Davydov2015,Boffi2016},
just to name a few.
The main aim of this thesis was to develop a quantum-chemistry
package, which supports such research directions
by offering a common platform for developing, testing and analysing
quantum-chemical methods irrespective of the basis function type employed for
the discretisation.
This is the package \molsturm,
which will be presented in chapter \vref{ch:Molsturm}.

\begin{figure}
	\centering
	\missingfigure{Instead of having the figures here,
	refer to fig. \vref{fig:StructureFiniteElementFock}, \vref{fig:StructureGaussianFock}
	and \vref{fig:StructureSturmianFock}}
	%
	\caption{
		Structure of the Fock matrix for the beryllium atom
		in a restricted Hartree-Fock self-consistent field procedure
		employing in each case the indicated basis function type
		for the discretisation.
		%
		The colour of a pixel represents the logarithm
		of the absolute value of the appropriate matrix element
		according to the scale given on the right hand side.
		%
		In each case the matrices are shown early in the self-consistent
		field procedure with a Pulay error Frobenius norm larger than 0.1.
	}
	\label{fig:FockStructure}
\end{figure}

For a thorough investigation of such new types of basis functions
both the implementation of the algorithms computing
the one-electron and electron-repulsion integrals
as well as a systematic comparison
with already existing basis function types is required.
This can either be achieved by writing a separate program,
which has the disadvantage that well-established algorithms
for all kinds of quantum-chemistry methods need to be re-implemented
in the new setting.
On the other hand one may also implement
the new routines into the framework of an already existing
electronic structure theory code.
Since most existing codes
are built around only one particular basis function type
and are highly optimised for the numerical requirements
of this particular basis,
implementing a new basis function type can become a daunting task.

To illustrate this latter point let us consider
the usual ansatz of solving the Hartree-Fock~(HF) equations
in a self-consistent field~(SCF) procedure.
Fig.~\ref{fig:FockStructure} shows the structure of the Fock matrix
arising if various basis function types are employed for the discretisation.
Whilst the 
Coulomb-Sturmian and Gaussian matrices are almost
diagonal dominant, even almost strictly diagonal dominant,
about half the rows in the finite-element matrix
sum to more than twice the diagonal,
i.e. violate the condition for diagonal dominance.
On the other hand the finite-element matrix is more sparse,
but also much larger than the other two types of matrices.
One should mention that the finite-element discretisation depicted here
is still far too inaccurate to yield a sensible description
of the Beryllium atom density.
A realistic description would need in the order of $10^5$ to $10^6$ basis
functions, see \eg reference \cite{Davydov2015}.

As a result of these structural differences
the required numerical algorithms for a
diagonalisation of these matrices differ as well.
In fact for finite-element methods subspace-based, iterative
algorithms like Arnoldi~\cite{Arnoldi1951} or Davidson~\cite{Davidson1975}
iteration are typically employed for diagonalisation.
Recent advances in this field have developed these algorithms
further to so-called matrix-free methods~\cite{Kronbichler2012},
which avoid building the diagonalised matrix in memory at all.
Instead one only passes an \emph{expression} for the
computation of the matrix-vector product to the eigensolver.
Since such expressions may involve arbitrary tensor contractions,
like the ones occurring in the computation of the
exchange part of the Fock matrix,
we will refer to such methods
by the term \contraction-based methods.

In many cases \contraction-based approaches
have more advantages than saving memory.
For both finite elements as well as for Coulomb-Sturmians
for example a \contraction-based ansatz
allows to reformulate the matrix-vector product in a way
that the computational complexity is reduced.
An important point to note is that
a \contraction-based diagonalisation algorithm
does not prevent one from building the matrix in memory still.
As such it is not only favourable for the aforementioned
types of functions,
but it furthermore leads to no disadvantages
for diagonalising a Fock matrix originating from
a contracted Gaussian basis set.

Considering the flexibility which results from such approaches,
they are a perfect ingredient for
a quantum-chemical method development framework
supporting the numerical requirements of various types of basis functions.
Such a framework has been missing up to today to the best of our knowledge.

The reader is assumed to have some background in classical physics
and a solid idea about basic analysis and algebraic structures.
The other concepts will be revised and developed in the first chapter.

\todoil{Structure of the thesis}
