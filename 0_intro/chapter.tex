\chapter{Introduction}
\label{ch:Intro}
\chapquote{%
The underlying physical laws necessary for the mathematical theory
of a large part of physics and the whole of chemistry are thus completely known,
and the difficulty is only that the exact application of these
laws leads to equations much too complicated to be soluble.
It therefore becomes desirable that approximate practical methods
of applying quantum mechanics should be developed,
which can lead to an explanation of the main features
of complex atomic systems without too much computation.}
{Paul Adrien Maurice Dirac (1902--1984)}

\noindent
Experimental chemistry
has already been performed thousands of years ago
in the form of alchemy, metallurgy, pottery and dye making.
Gradually,
in the 17th and 18th century,
chemistry transformed into a mature science,
where new theories were developed based on
experimental evidence rather than philosophical thought.
The 19th century marked the appearance of thermodynamics,
which provided a theoretical foundation
to quantitatively describe the physical processes of chemical reactions.
Whilst this already allowed to deductively reach predictions of chemical processes,
a full understanding of the microscopic behaviour
of chemical systems was not available until the appearance
of quantum mechanics at the turn of the 20th century.
By now the application of quantum mechanics for the modelling of chemical processes
has grown into a field on its own, known as \newterm{quantum chemistry}.

Compared to experimental chemistry, quantum chemistry is thus relatively new.
Still, as \citet{Dirac1929} noted already in \citeyear{Dirac1929},
all fundamental equations of quantum chemistry,
in the form of the mathematical formulation of quantum mechanics, are known.
Whilst solving these equations exactly is possible for model systems,
solving them for any chemically or physically
interesting system is only feasible using approximate methods.
Which methods best employed depends largely on the intended application,
\ie the complexity of the chemical system
or the properties and behaviours to be described.
Over the years a hierarchy of approximations has been developed for this reason,
ranging from crude to numerically exact
or from highly specialised to generally applicable.
Nowadays the modelling of chemical processes
based on quantum-chemical arguments
is well-established both in industry and research.

The aforementioned aspects of accuracy and applicability
are to be seen in contrast to computational demand.
Generally speaking, the more specific the setting one has in mind
and the more accuracy can be sacrificed,
the more computationally cheap the resulting quantum-chemical methods become.
In electronic structure theory, for example,
one typically neglects the motion of the nuclei
in order to yield a simplified equation --- the electronic Schrödinger equation.
With approximate solutions to this equation
at hand, already many aspects of chemical reactivity or spectroscopy
can be modelled, even though the nuclei are assumed to be motionless in this picture.

For most if not all practically relevant problems,
the full description of a chemical system
on the level of the electronic Schrödinger equation is still not possible
and further approximations are required.
One particular ansatz is the Hartree-Fock~(\HF) method,
where the interaction of the electrons amongst themselves
is only treated in an averaged manner.
This leads to a much more computationally feasible problem,
since individual electrons of a chemical system no longer couple directly,
but only via a mean field generated by all electrons collectively.
The many-body problem of the electronic Schrödinger equation
thus becomes an effective one-electron problem.
The downside of this is that some of the chemically relevant physics,
namely parts of the electron-electron interaction, is lost
and a second so-called Post-\HF method is needed
on top of the \HF solution to correct for this.
Various levels of Post-\HF corrections are available,
but in practice not all levels are reachable due to the
increasing complexity of the problem.
On the other hand, in order to gain insight
into a particular research question,
the most accurate treatment is not necessarily required.
The approach of a \HF calculation followed by a Post-\HF method sketched here,
is not the only way to model chemical systems.
An alternative route is density-functional theory~(\DFT),
where the approach is to directly work with the electron density
instead of the wave function.
Due to its good combination of accuracy and computational cost
for many problems of electronic structure theory,
\DFT has become widely adopted.

Since the underlying function spaces of quantum mechanics are infinite dimensional
all of the aforementioned methods
involve infinite-dimensional spaces as well.
For a numerical treatment on a computer with finite amounts of memory,
this is of course an insurmountable obstacle.
The remedy in practice is yet another approximation,
where one restricts the problem spaces
to a finite number of dimensions by only considering subspaces
spanned by a finite number of single-particle basis functions.
Such a restriction is called a discretisation
and has the pleasant side effect that the partial differential equations
dictated by quantum mechanics
reduce to standard problems of linear algebra.
In the case of \HF, for example,
the discretised problem may be solved by repetitively diagonalising
the arising so-called Fock matrix.

This naturally leads to the question:
Which type of basis functions should be used to span the subspace
for modelling at \HF, \DFT or Post-\HF level?
Most available program packages for
quantum-chemical calculations of molecules nowadays employ methodologies based on
the linear combination of Gaussian-shaped atomic orbital functions.
This predominance can be rationalised
by the pragmatic historic developments
taking place in the founding years of modern electronic structure theory.
\citet{Boys1950} realised in \citeyear{Boys1950}
that evaluating the integrals
required for solving \HF is much more feasible for Gaussian-type orbitals
compared to the physically more suitable Slater-type orbitals~\cite{Slater1930}.
This idea was picked up and refined later~\cite{Hehre1969}
and eventually set off many developments
both in terms of efficient algorithms as well as methodologies
centred around Gaussian basis functions,
spreading their use for simulating the electronic structures of molecules.

Unfortunately Gaussian-type orbitals have major drawbacks
caused by their unphysical shape:
They are not able to represent
all features of the electron density well.
Most prominently they fail to describe the cusp of the electron density
at the position of a nucleus as well as its exponential decay behaviour~\cite{Kato1957}.
In most practical use cases this is acceptable,
since the important quantity for understanding chemical processes
is not the absolute energy of a molecule.
Much rather chemistry is all about the energy differences
between the involved species or electronic configurations.
Since changes in the electronic structure both at the nucleus as well as
the region far from the nuclei are generally much less pronounced,
the errors resulting from an inadequate description
of these features tend to cancel one another.
For cases where they do become important
one can usually compensate by employing specialised Gaussian
basis sets~\cite{Jensen2013,Hill2013} up to some extent.
There are strong indications, however,
that the accurate computation of some physical properties
like nuclear magnetic resonance (NMR) shielding tensors~\cite{Guell2008,Hoggan2009}
requires a correct description of both aforementioned features.
Additionally, those specialised basis sets can lead to
numerical instabilities in the resulting linear algebra due to their overcompleteness,
making it numerically more challenging to obtain reliable results.

Multiple research groups have therefore looked
into alternative types of basis functions
for the modelling of molecular structures.
Examples include so-called numerical basis functions~\cite{Frediani2015}
like wavelets%
~\cite{Bischoff2011,Bischoff2012,Bischoff2013,Bischoff2014,Bischoff2014a,Bischoff2017}
or finite elements%
~\cite{Tsuchida1995,Soler2002,Lehtovaara2009,Alizadegan2010,Avery2011PhD,Davydov2015,Boffi2016}.
Both of these are interesting because they allow for rigorous error bounds
to be derived on the obtained result,
essentially leading to a modelling of a chemical system with guaranteed
numerical precision.
Another promising approach are Sturmian-type functions
like Coulomb-Sturmians~\cite{Shull1959,Rotenberg1962,Rotenberg1970,Gruzdev1990,Hoggan2009,Randazzo2010}
or generalised Sturmians~\cite{Avery2006,Avery2011PhD,Avery2011,Morales2016,Avery2017,Randazzo2015,Granados2016},
since they amount to correctly represent
the physical features of the electron density
and furthermore lead to more feasible integrals than Slater-type orbitals.
Their use in quantum-chemistry is, however, not well-established.

There are some further aspects to consider in such a discussion about basis functions
for the modelling of electronic structures.
First of all our discussion has ignored
a very important feature of the electronic structure,
namely the electron-electron cusp.
It has been shown that a proper modelling of this feature of the wave function
is important in order to reach rapid convergence for Post-\HF methods~\cite{Kong2012}.
A simple single-particle basis such as the Gaussian-type
orbitals cannot properly account for this,
since these functions have no direct notion of the electron-electron distance.
Recent attempts to tackle this issue are so-called
explicitly correlated methods~\cite{Kong2012}.
In a nutshell these methods change the underlying
basis from the usual Gaussian-type orbitals to so-called Gaussian geminals,
where an explicit dependence on the electron-electron
distance is directly incorporated inside the basis functions.
The result is much faster convergence for Post-\HF methods~\cite{Kong2012}.

Furthermore we only took the viewpoint of modelling
individual molecules so far, mainly because this will be the focus of the thesis.
But the modelling of electronic structures is not restricted to single molecules.
Periodic or extended systems are accessible
for quantum-chemical simulations as well.
For these a combination of \DFT as the underlying quantum-chemical method
with a plane-waves or a projector-augmented wave basis
are well-established and highly suitable%
~\cite{Kresse1996,Kresse1999,Mortensen2005,Enkovaara2010}.

\begin{figure}
	\centering
	\includeimage[width=\textwidth]{4_solving_hf/fock_fe_gauss_sturm}  \\[-1.3em]
	{\smaller
	\begin{tabular}{lc@{\hspace{14pt}}ccl}
		\hspace{0.017\textwidth} &
		\hspace{0.25\textwidth} & \hspace{0.26\textwidth} & \hspace{0.25\textwidth} &
		\hspace{0.1\textwidth} \\
		&Finite elements     & Contracted Gaussians & Coulomb-Sturmians \\
	\end{tabular}
	} \\[-0.3em]
	\caption[Structure of the Fock matrices resulting from different discretisations]{
		Structure of typical Fock matrices taken from a Hartree-Fock
		calculation for beryllium if the indicated basis function types
		were used for the discretisation.
		The absolute values of the matrices are depicted to the same scale
		with elements smaller than $10^{-10}$ coloured in white.
	}
	\label{fig:IntroFockStructure}
\end{figure}

This overview suggests
that going beyond the usual Gaussian-based discretisations
and towards employing novel basis function types
could potentially yield quantum-chemical methods,
which might allow for a more suitable description
of certain features and properties.
One of the challenges for developing such new methods
are the deviating mathematical properties
between conventional Gaussian-type orbitals
as well as alternative basis functions.
As an example figure~\ref{fig:IntroFockStructure} shows the structure of the
Fock matrix when discretisations
using finite elements, contracted Gaussians
or Coulomb-Sturmians are employed.
The most drastic difference can be seen for a finite-element discretisation,
where the matrix is both much larger as well as sparser
compared to the other two cases.
In fact the discretisation which gave rise to the
Fock matrix depicted in figure~\ref{fig:IntroFockStructure}
is still too small to yield a
sensible description of the Beryllium atom density.
A realistic description would need on the order of $10^5$ to $10^6$ basis
functions~\cite{Davydov2015}.
For this reason it is not possible to keep the finite-element discretised
Fock matrix completely in memory and diagonalise it at once,
which is the standard approach when employing contracted Gaussians.
Instead iterative diagonalisation methods need to be used for finite elements.
Coulomb-Sturmians are some sort of a middle ground,
where iterative methods are not necessarily required,
but open up the possibility for more efficient algorithms,
as we will discuss in more detail later in this work.
The implementation of alternative basis function types
therefore requires in many cases other numerical techniques
compared to Gaussian-based discretisations.

% Henrik: Nice paragraph
As mentioned before existing packages for quantum-chemical calculations
predominantly rely on Gaussian-type orbitals
and as a consequence are highly optimised towards their properties.
Implicit assumptions
about the structure of the discretised quantities,
like the Fock matrix shown above,
are thus typically scattered throughout these large codes
making the implementation of alternative types of basis functions
rather challenging and time consuming.
Especially for the initial testing of novel methods
towards their range of applicability
in standard problems of electronic structure theory
this is an obstacle.
On the other hand starting from scratch for each new basis function type
is not an ideal option either,
since one is faced with the task of reprogramming all the algorithms for which
already hundreds of man-years of development have been spent in existing programs.

In this thesis a different approach is presented,
which is followed by the \molsturm%
\footnote{\url{https://molsturm.org}}
program package~\cite{molsturmWeb}.
Motivated by the mathematical structure of the \HF problem
and the self-consistent field~(\SCF) approach usually utilised
to solve it, \molsturm is designed
to be a quantum-chemical method development framework,
which supports experimentation at all levels.
The \SCF process in \molsturm uses a contraction-based approach,
where the Fock matrix is not stored in memory,
but where matrix-vector contraction expressions are sufficient.
As will be discussed, this allows to separate the code dealing with the \SCF scheme
from the basis-function specific details,
such that the \SCF code is highly general,
but the integral back end is still in full control
over the way integral data is produced and consumed.
A key result is that new types of basis functions
as well as new \SCF algorithms can be readily incorporated
and tried within the existing framework.
It is explicitly \emph{not} the goal of \molsturm to recode
every aspect of quantum-chemical modelling,
but instead to facilitate integration
of the implemented \SCF procedure
with existing software for Post-\HF methods
by simple and easy-to-use interfaces.
One can best think of \molsturm as a mediator
between integral libraries and Post-\HF methods,
where new developments on either side
can be quickly connected and tested for their applicability
in the quantum-chemical modelling of electronic structures.

Following along these lines chapter
\ref{ch:QM} and chapter \ref{ch:numeigen}
provide the background for treating the problems of quantum mechanics
as well as quantum chemistry numerically.
Starting from the similarities of classical and quantum physics
the reader will be introduced to functional analysis
and spectral theory in chapter \ref{ch:QM},
always motivated from a quantum-chemical perspective.
In chapter \ref{ch:numeigen} we introduce standard projection techniques
for transforming from the picture of exact mathematics
into the field of numerical linear algebra,
which allows to solve quantum-chemical problems on a computer.

Thereafter chapter \ref{ch:qchem}
deals with the mathematical and numerical structure of quantum chemistry
with a strong focus on the \HF problem.
Chapter \ref{ch:NumSolveHF}
follows with a detailed review of numerical techniques and \SCF algorithms
for solving \HF.

Chapter \ref{ch:LazyMatrices}
picks up on the lessons learned about the numerical structure
of \HF and discusses
\contraction-based methods and so-called lazy matrices
in order to program algorithms
in a basis-function independent way.
In chapter \ref{ch:Molsturm} the design of the quantum-chemistry
package \molsturm is presented,
emphasising its usefulness for investigating novel methods
for quantum-chemical calculations
and computational electronic structure theory.

In chapter \ref{ch:CSQChem} we employ \molsturm
to perform a systematic assessment of
the convergence properties of Coulomb-Sturmians
for the quantum-chemical modelling of atoms
and make some suggestions regarding
sensible Coulomb-Sturmian basis sets for ground state calculations of atoms
at \HF level of theory.
Finally chapter \ref{ch:Conclusion} concludes the work and
chapter \ref{ch:Prospects} gives
an outlook into further directions of research.
